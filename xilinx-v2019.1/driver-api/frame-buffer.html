

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Frame Buffer Library &mdash; The Linux Kernel  documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  

  
    <link rel="top" title="The Linux Kernel  documentation" href="../index.html"/>
        <link rel="up" title="The Linux driver implementerâ€™s API guide" href="index.html"/>
        <link rel="next" title="Voltage and current regulator API" href="regulator.html"/>
        <link rel="prev" title="Sound Devices" href="sound.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                4.19.0-xilinx-v2019.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../process/license-rules.html">Linux kernel licensing rules</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/index.html">The Linux kernel user&#8217;s and administrator&#8217;s guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../userspace-api/index.html">The Linux kernel user-space API guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../process/index.html">Working with the kernel development community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trace/index.html">Linux Tracing Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maintainer/index.html">Kernel Maintainer Handbook</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">The Linux driver implementer&#8217;s API guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="basics.html">Driver Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="infrastructure.html">Device drivers infrastructure</a></li>
<li class="toctree-l2"><a class="reference internal" href="pm/index.html">Device Power Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="clk.html">The Common Clk Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="device-io.html">Bus-Independent Device Accesses</a></li>
<li class="toctree-l2"><a class="reference internal" href="device_connection.html">Device connections</a></li>
<li class="toctree-l2"><a class="reference internal" href="dma-buf.html">Buffer Sharing and Synchronization</a></li>
<li class="toctree-l2"><a class="reference internal" href="device_link.html">Device links</a></li>
<li class="toctree-l2"><a class="reference internal" href="message-based.html">Message-based devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="sound.html">Sound Devices</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="">Frame Buffer Library</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#frame-buffer-memory">Frame Buffer Memory</a></li>
<li class="toctree-l3"><a class="reference internal" href="#frame-buffer-colormap">Frame Buffer Colormap</a></li>
<li class="toctree-l3"><a class="reference internal" href="#frame-buffer-video-mode-database">Frame Buffer Video Mode Database</a></li>
<li class="toctree-l3"><a class="reference internal" href="#frame-buffer-macintosh-video-mode-database">Frame Buffer Macintosh Video Mode Database</a></li>
<li class="toctree-l3"><a class="reference internal" href="#frame-buffer-fonts">Frame Buffer Fonts</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="regulator.html">Voltage and current regulator API</a></li>
<li class="toctree-l2"><a class="reference internal" href="iio/index.html">Industrial I/O</a></li>
<li class="toctree-l2"><a class="reference internal" href="input.html">Input Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb/index.html">Linux USB API</a></li>
<li class="toctree-l2"><a class="reference internal" href="pci.html">PCI Support Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="pci.html#pci-hotplug-support-library">PCI Hotplug Support Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="spi.html">Serial Peripheral Interface (SPI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="i2c.html">I<sup>2</sup>C and SMBus Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="hsi.html">High Speed Synchronous Serial Interface (HSI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="edac.html">Error Detection And Correction (EDAC) Devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="scsi.html">SCSI Interfaces Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="libata.html">libATA Developer&#8217;s Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="target.html">target and iSCSI Interfaces Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="mtdnand.html">MTD NAND Driver Programming Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="miscellaneous.html">Parallel Port Devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="miscellaneous.html#x50-uart-driver">16x50 UART Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="miscellaneous.html#pulse-width-modulation-pwm">Pulse-Width Modulation (PWM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="w1.html">W1: Dallas&#8217; 1-wire bus</a></li>
<li class="toctree-l2"><a class="reference internal" href="rapidio.html">RapidIO Subsystem Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="s390-drivers.html">Writing s390 channel device drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="vme.html">VME Device Drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="80211/index.html">Linux 802.11 Driver Developer&#8217;s Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="uio-howto.html">The Userspace I/O HOWTO</a></li>
<li class="toctree-l2"><a class="reference internal" href="firmware/index.html">Linux Firmware API</a></li>
<li class="toctree-l2"><a class="reference internal" href="pinctl.html">PINCTRL (PIN CONTROL) subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="gpio/index.html">General Purpose Input/Output (GPIO)</a></li>
<li class="toctree-l2"><a class="reference internal" href="misc_devices.html">Miscellaneous Devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="dmaengine/index.html">DMAEngine documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="slimbus.html">Linux kernel SLIMbus support</a></li>
<li class="toctree-l2"><a class="reference internal" href="soundwire/index.html">SoundWire Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="fpga/index.html">FPGA Subsystem</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../media/index.html">Linux Media Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../networking/index.html">Linux Networking Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input/index.html">The Linux Input Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu/index.html">Linux GPU Driver Developer&#8217;s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security/index.html">Security Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sound/index.html">Linux Sound Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../crypto/index.html">Linux Kernel Crypto API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../filesystems/index.html">Linux Filesystems API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vm/index.html">Linux Memory Management Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bpf/index.html">BPF Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc-devices/index.html">Assorted Miscellaneous Devices Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../sh/index.html">SuperH Interfaces Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../filesystems/ext4/index.html">ext4 Filesystem</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../translations/index.html">Translations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">The Linux Kernel</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">The Linux driver implementer&#8217;s API guide</a> &raquo;</li>
      
    <li>Frame Buffer Library</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/driver-api/frame-buffer.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="frame-buffer-library">
<h1>Frame Buffer Library<a class="headerlink" href="#frame-buffer-library" title="Permalink to this headline">Â¶</a></h1>
<p>The frame buffer drivers depend heavily on four data structures. These
structures are declared in include/linux/fb.h. They are fb_info,
fb_var_screeninfo, fb_fix_screeninfo and fb_monospecs. The last
three can be made available to and from userland.</p>
<p>fb_info defines the current state of a particular video card. Inside
fb_info, there exists a fb_ops structure which is a collection of
needed functions to make fbdev and fbcon work. fb_info is only visible
to the kernel.</p>
<p>fb_var_screeninfo is used to describe the features of a video card
that are user defined. With fb_var_screeninfo, things such as depth
and the resolution may be defined.</p>
<p>The next structure is fb_fix_screeninfo. This defines the properties
of a card that are created when a mode is set and can&#8217;t be changed
otherwise. A good example of this is the start of the frame buffer
memory. This &#8220;locks&#8221; the address of the frame buffer memory, so that it
cannot be changed or moved.</p>
<p>The last structure is fb_monospecs. In the old API, there was little
importance for fb_monospecs. This allowed for forbidden things such as
setting a mode of 800x600 on a fix frequency monitor. With the new API,
fb_monospecs prevents such things, and if used correctly, can prevent a
monitor from being cooked. fb_monospecs will not be useful until
kernels 2.5.x.</p>
<div class="section" id="frame-buffer-memory">
<h2>Frame Buffer Memory<a class="headerlink" href="#frame-buffer-memory" title="Permalink to this headline">Â¶</a></h2>
<dl class="function">
<dt id="c.register_framebuffer">
int <code class="descname">register_framebuffer</code><span class="sig-paren">(</span>struct fb_info *<em>&nbsp;fb_info</em><span class="sig-paren">)</span><a class="headerlink" href="#c.register_framebuffer" title="Permalink to this definition">Â¶</a></dt>
<dd><p>registers a frame buffer device</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">fb_info</span> <span class="pre">*</span> <span class="pre">fb_info</span></code></dt>
<dd>frame buffer info structure</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div><p>Registers a frame buffer device <strong>fb_info</strong>.</p>
<p>Returns negative errno on error, or zero for success.</p>
</div></blockquote>
<dl class="function">
<dt id="c.unregister_framebuffer">
int <code class="descname">unregister_framebuffer</code><span class="sig-paren">(</span>struct fb_info *<em>&nbsp;fb_info</em><span class="sig-paren">)</span><a class="headerlink" href="#c.unregister_framebuffer" title="Permalink to this definition">Â¶</a></dt>
<dd><p>releases a frame buffer device</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">fb_info</span> <span class="pre">*</span> <span class="pre">fb_info</span></code></dt>
<dd>frame buffer info structure</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div><p>Unregisters a frame buffer device <strong>fb_info</strong>.</p>
<p>Returns negative errno on error, or zero for success.</p>
<p>This function will also notify the framebuffer console
to release the driver.</p>
<p>This is meant to be called within a driver&#8217;s <a class="reference internal" href="basics.html#c.module_exit" title="module_exit"><code class="xref c c-func docutils literal"><span class="pre">module_exit()</span></code></a>
function. If this is called outside <a class="reference internal" href="basics.html#c.module_exit" title="module_exit"><code class="xref c c-func docutils literal"><span class="pre">module_exit()</span></code></a>, ensure
that the driver implements <code class="xref c c-func docutils literal"><span class="pre">fb_open()</span></code> and <code class="xref c c-func docutils literal"><span class="pre">fb_release()</span></code> to
check that no processes are using the device.</p>
</div></blockquote>
<dl class="function">
<dt id="c.fb_set_suspend">
void <code class="descname">fb_set_suspend</code><span class="sig-paren">(</span>struct fb_info *<em>&nbsp;info</em>, int<em>&nbsp;state</em><span class="sig-paren">)</span><a class="headerlink" href="#c.fb_set_suspend" title="Permalink to this definition">Â¶</a></dt>
<dd><p>low level driver signals suspend</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">fb_info</span> <span class="pre">*</span> <span class="pre">info</span></code></dt>
<dd>framebuffer affected</dd>
<dt><code class="docutils literal"><span class="pre">int</span> <span class="pre">state</span></code></dt>
<dd>0 = resuming, !=0 = suspending</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div>This is meant to be used by low level drivers to
signal suspend/resume to the core &amp; clients.
It must be called with the console semaphore held</div></blockquote>
</div>
<div class="section" id="frame-buffer-colormap">
<h2>Frame Buffer Colormap<a class="headerlink" href="#frame-buffer-colormap" title="Permalink to this headline">Â¶</a></h2>
<dl class="function">
<dt id="c.fb_dealloc_cmap">
void <code class="descname">fb_dealloc_cmap</code><span class="sig-paren">(</span>struct fb_cmap *<em>&nbsp;cmap</em><span class="sig-paren">)</span><a class="headerlink" href="#c.fb_dealloc_cmap" title="Permalink to this definition">Â¶</a></dt>
<dd><p>deallocate a colormap</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">fb_cmap</span> <span class="pre">*</span> <span class="pre">cmap</span></code></dt>
<dd>frame buffer colormap structure</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div>Deallocates a colormap that was previously allocated with
<code class="xref c c-func docutils literal"><span class="pre">fb_alloc_cmap()</span></code>.</div></blockquote>
<dl class="function">
<dt id="c.fb_copy_cmap">
int <code class="descname">fb_copy_cmap</code><span class="sig-paren">(</span>const struct fb_cmap *<em>&nbsp;from</em>, struct fb_cmap *<em>&nbsp;to</em><span class="sig-paren">)</span><a class="headerlink" href="#c.fb_copy_cmap" title="Permalink to this definition">Â¶</a></dt>
<dd><p>copy a colormap</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">fb_cmap</span> <span class="pre">*</span> <span class="pre">from</span></code></dt>
<dd>frame buffer colormap structure</dd>
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">fb_cmap</span> <span class="pre">*</span> <span class="pre">to</span></code></dt>
<dd>frame buffer colormap structure</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div>Copy contents of colormap from <strong>from</strong> to <strong>to</strong>.</div></blockquote>
<dl class="function">
<dt id="c.fb_set_cmap">
int <code class="descname">fb_set_cmap</code><span class="sig-paren">(</span>struct fb_cmap *<em>&nbsp;cmap</em>, struct fb_info *<em>&nbsp;info</em><span class="sig-paren">)</span><a class="headerlink" href="#c.fb_set_cmap" title="Permalink to this definition">Â¶</a></dt>
<dd><p>set the colormap</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">fb_cmap</span> <span class="pre">*</span> <span class="pre">cmap</span></code></dt>
<dd>frame buffer colormap structure</dd>
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">fb_info</span> <span class="pre">*</span> <span class="pre">info</span></code></dt>
<dd>frame buffer info structure</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div><p>Sets the colormap <strong>cmap</strong> for a screen of device <strong>info</strong>.</p>
<p>Returns negative errno on error, or zero on success.</p>
</div></blockquote>
<dl class="function">
<dt id="c.fb_default_cmap">
const struct fb_cmap * <code class="descname">fb_default_cmap</code><span class="sig-paren">(</span>int<em>&nbsp;len</em><span class="sig-paren">)</span><a class="headerlink" href="#c.fb_default_cmap" title="Permalink to this definition">Â¶</a></dt>
<dd><p>get default colormap</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">int</span> <span class="pre">len</span></code></dt>
<dd>size of palette for a depth</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div><p>Gets the default colormap for a specific screen depth.  <strong>len</strong>
is the size of the palette for a particular screen depth.</p>
<p>Returns pointer to a frame buffer colormap structure.</p>
</div></blockquote>
<dl class="function">
<dt id="c.fb_invert_cmaps">
void <code class="descname">fb_invert_cmaps</code><span class="sig-paren">(</span>void<span class="sig-paren">)</span><a class="headerlink" href="#c.fb_invert_cmaps" title="Permalink to this definition">Â¶</a></dt>
<dd><p>invert all defaults colormaps</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">void</span></code></dt>
<dd>no arguments</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div>Invert all default colormaps.</div></blockquote>
</div>
<div class="section" id="frame-buffer-video-mode-database">
<h2>Frame Buffer Video Mode Database<a class="headerlink" href="#frame-buffer-video-mode-database" title="Permalink to this headline">Â¶</a></h2>
<dl class="function">
<dt id="c.fb_try_mode">
int <code class="descname">fb_try_mode</code><span class="sig-paren">(</span>struct fb_var_screeninfo *<em>&nbsp;var</em>, struct fb_info *<em>&nbsp;info</em>, const struct fb_videomode *<em>&nbsp;mode</em>, unsigned int<em>&nbsp;bpp</em><span class="sig-paren">)</span><a class="headerlink" href="#c.fb_try_mode" title="Permalink to this definition">Â¶</a></dt>
<dd><p>test a video mode</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">fb_var_screeninfo</span> <span class="pre">*</span> <span class="pre">var</span></code></dt>
<dd>frame buffer user defined part of display</dd>
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">fb_info</span> <span class="pre">*</span> <span class="pre">info</span></code></dt>
<dd>frame buffer info structure</dd>
<dt><code class="docutils literal"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">fb_videomode</span> <span class="pre">*</span> <span class="pre">mode</span></code></dt>
<dd>frame buffer video mode structure</dd>
<dt><code class="docutils literal"><span class="pre">unsigned</span> <span class="pre">int</span> <span class="pre">bpp</span></code></dt>
<dd>color depth in bits per pixel</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div><p>Tries a video mode to test it&#8217;s validity for device <strong>info</strong>.</p>
<p>Returns 1 on success.</p>
</div></blockquote>
<dl class="function">
<dt id="c.fb_delete_videomode">
void <code class="descname">fb_delete_videomode</code><span class="sig-paren">(</span>const struct fb_videomode *<em>&nbsp;mode</em>, struct list_head *<em>&nbsp;head</em><span class="sig-paren">)</span><a class="headerlink" href="#c.fb_delete_videomode" title="Permalink to this definition">Â¶</a></dt>
<dd><p>removed videomode entry from modelist</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">fb_videomode</span> <span class="pre">*</span> <span class="pre">mode</span></code></dt>
<dd>videomode to remove</dd>
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">list_head</span> <span class="pre">*</span> <span class="pre">head</span></code></dt>
<dd>struct list_head of modelist</dd>
</dl>
<p><strong>NOTES</strong></p>
<p>Will remove all matching mode entries</p>
<dl class="function">
<dt id="c.fb_find_mode">
int <code class="descname">fb_find_mode</code><span class="sig-paren">(</span>struct fb_var_screeninfo *<em>&nbsp;var</em>, struct fb_info *<em>&nbsp;info</em>, const char *<em>&nbsp;mode_option</em>, const struct fb_videomode *<em>&nbsp;db</em>, unsigned int<em>&nbsp;dbsize</em>, const struct fb_videomode *<em>&nbsp;default_mode</em>, unsigned int<em>&nbsp;default_bpp</em><span class="sig-paren">)</span><a class="headerlink" href="#c.fb_find_mode" title="Permalink to this definition">Â¶</a></dt>
<dd><p>finds a valid video mode</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">fb_var_screeninfo</span> <span class="pre">*</span> <span class="pre">var</span></code></dt>
<dd>frame buffer user defined part of display</dd>
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">fb_info</span> <span class="pre">*</span> <span class="pre">info</span></code></dt>
<dd>frame buffer info structure</dd>
<dt><code class="docutils literal"><span class="pre">const</span> <span class="pre">char</span> <span class="pre">*</span> <span class="pre">mode_option</span></code></dt>
<dd>string video mode to find</dd>
<dt><code class="docutils literal"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">fb_videomode</span> <span class="pre">*</span> <span class="pre">db</span></code></dt>
<dd>video mode database</dd>
<dt><code class="docutils literal"><span class="pre">unsigned</span> <span class="pre">int</span> <span class="pre">dbsize</span></code></dt>
<dd>size of <strong>db</strong></dd>
<dt><code class="docutils literal"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">fb_videomode</span> <span class="pre">*</span> <span class="pre">default_mode</span></code></dt>
<dd>default video mode to fall back to</dd>
<dt><code class="docutils literal"><span class="pre">unsigned</span> <span class="pre">int</span> <span class="pre">default_bpp</span></code></dt>
<dd>default color depth in bits per pixel</dd>
</dl>
<p><strong>Description</strong></p>
<p>Finds a suitable video mode, starting with the specified mode
in <strong>mode_option</strong> with fallback to <strong>default_mode</strong>.  If
<strong>default_mode</strong> fails, all modes in the video mode database will
be tried.</p>
<p>Valid mode specifiers for <strong>mode_option</strong>:</p>
<div class="highlight-none"><div class="highlight"><pre>&lt;xres&gt;x&lt;yres&gt;[M][R][-&lt;bpp&gt;][@&lt;refresh&gt;][i][p][m]
</pre></div>
</div>
<p>or</p>
<div class="highlight-none"><div class="highlight"><pre>&lt;name&gt;[-&lt;bpp&gt;][@&lt;refresh&gt;]
</pre></div>
</div>
<p>with &lt;xres&gt;, &lt;yres&gt;, &lt;bpp&gt; and &lt;refresh&gt; decimal numbers and
&lt;name&gt; a string.</p>
<p>If &#8216;M&#8217; is present after yres (and before refresh/bpp if present),
the function will compute the timings using VESA(tm) Coordinated
Video Timings (CVT).  If &#8216;R&#8217; is present after &#8216;M&#8217;, will compute with
reduced blanking (for flatpanels).  If &#8216;i&#8217; or &#8216;p&#8217; are present, compute
interlaced or progressive mode.  If &#8216;m&#8217; is present, add margins equal
to 1.8% of xres rounded down to 8 pixels, and 1.8% of yres. The char
&#8216;i&#8217;, &#8216;p&#8217; and &#8216;m&#8217; must be after &#8216;M&#8217; and &#8216;R&#8217;. Example:</p>
<div class="highlight-none"><div class="highlight"><pre>1024x768MR-8@60m - Reduced blank with margins at 60Hz.
</pre></div>
</div>
<p><strong>NOTE</strong></p>
<p>The passed struct <strong>var</strong> is _not_ cleared!  This allows you
to supply values for e.g. the grayscale and accel_flags fields.</p>
<p>Returns zero for failure, 1 if using specified <strong>mode_option</strong>,
2 if using specified <strong>mode_option</strong> with an ignored refresh rate,
3 if default mode is used, 4 if fall back to any valid mode.</p>
<dl class="function">
<dt id="c.fb_var_to_videomode">
void <code class="descname">fb_var_to_videomode</code><span class="sig-paren">(</span>struct fb_videomode *<em>&nbsp;mode</em>, const struct fb_var_screeninfo *<em>&nbsp;var</em><span class="sig-paren">)</span><a class="headerlink" href="#c.fb_var_to_videomode" title="Permalink to this definition">Â¶</a></dt>
<dd><p>convert fb_var_screeninfo to fb_videomode</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">fb_videomode</span> <span class="pre">*</span> <span class="pre">mode</span></code></dt>
<dd>pointer to struct fb_videomode</dd>
<dt><code class="docutils literal"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">fb_var_screeninfo</span> <span class="pre">*</span> <span class="pre">var</span></code></dt>
<dd>pointer to struct fb_var_screeninfo</dd>
</dl>
<dl class="function">
<dt id="c.fb_videomode_to_var">
void <code class="descname">fb_videomode_to_var</code><span class="sig-paren">(</span>struct fb_var_screeninfo *<em>&nbsp;var</em>, const struct fb_videomode *<em>&nbsp;mode</em><span class="sig-paren">)</span><a class="headerlink" href="#c.fb_videomode_to_var" title="Permalink to this definition">Â¶</a></dt>
<dd><p>convert fb_videomode to fb_var_screeninfo</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">fb_var_screeninfo</span> <span class="pre">*</span> <span class="pre">var</span></code></dt>
<dd>pointer to struct fb_var_screeninfo</dd>
<dt><code class="docutils literal"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">fb_videomode</span> <span class="pre">*</span> <span class="pre">mode</span></code></dt>
<dd>pointer to struct fb_videomode</dd>
</dl>
<dl class="function">
<dt id="c.fb_mode_is_equal">
int <code class="descname">fb_mode_is_equal</code><span class="sig-paren">(</span>const struct fb_videomode *<em>&nbsp;mode1</em>, const struct fb_videomode *<em>&nbsp;mode2</em><span class="sig-paren">)</span><a class="headerlink" href="#c.fb_mode_is_equal" title="Permalink to this definition">Â¶</a></dt>
<dd><p>compare 2 videomodes</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">fb_videomode</span> <span class="pre">*</span> <span class="pre">mode1</span></code></dt>
<dd>first videomode</dd>
<dt><code class="docutils literal"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">fb_videomode</span> <span class="pre">*</span> <span class="pre">mode2</span></code></dt>
<dd>second videomode</dd>
</dl>
<p><strong>Return</strong></p>
<p>1 if equal, 0 if not</p>
<dl class="function">
<dt id="c.fb_find_best_mode">
const struct fb_videomode * <code class="descname">fb_find_best_mode</code><span class="sig-paren">(</span>const struct fb_var_screeninfo *<em>&nbsp;var</em>, struct list_head *<em>&nbsp;head</em><span class="sig-paren">)</span><a class="headerlink" href="#c.fb_find_best_mode" title="Permalink to this definition">Â¶</a></dt>
<dd><p>find best matching videomode</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">fb_var_screeninfo</span> <span class="pre">*</span> <span class="pre">var</span></code></dt>
<dd>pointer to struct fb_var_screeninfo</dd>
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">list_head</span> <span class="pre">*</span> <span class="pre">head</span></code></dt>
<dd>pointer to struct list_head of modelist</dd>
</dl>
<p><strong>Return</strong></p>
<p>struct fb_videomode, NULL if none found</p>
<p>IMPORTANT:
This function assumes that all modelist entries in
info-&gt;modelist are valid.</p>
<p><strong>NOTES</strong></p>
<p>Finds best matching videomode which has an equal or greater dimension than
var-&gt;xres and var-&gt;yres.  If more than 1 videomode is found, will return
the videomode with the highest refresh rate</p>
<dl class="function">
<dt id="c.fb_find_nearest_mode">
const struct fb_videomode * <code class="descname">fb_find_nearest_mode</code><span class="sig-paren">(</span>const struct fb_videomode *<em>&nbsp;mode</em>, struct list_head *<em>&nbsp;head</em><span class="sig-paren">)</span><a class="headerlink" href="#c.fb_find_nearest_mode" title="Permalink to this definition">Â¶</a></dt>
<dd><p>find closest videomode</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">fb_videomode</span> <span class="pre">*</span> <span class="pre">mode</span></code></dt>
<dd>pointer to struct fb_videomode</dd>
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">list_head</span> <span class="pre">*</span> <span class="pre">head</span></code></dt>
<dd>pointer to modelist</dd>
</dl>
<p><strong>Description</strong></p>
<p>Finds best matching videomode, smaller or greater in dimension.
If more than 1 videomode is found, will return the videomode with
the closest refresh rate.</p>
<dl class="function">
<dt id="c.fb_match_mode">
const struct fb_videomode * <code class="descname">fb_match_mode</code><span class="sig-paren">(</span>const struct fb_var_screeninfo *<em>&nbsp;var</em>, struct list_head *<em>&nbsp;head</em><span class="sig-paren">)</span><a class="headerlink" href="#c.fb_match_mode" title="Permalink to this definition">Â¶</a></dt>
<dd><p>find a videomode which exactly matches the timings in var</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">fb_var_screeninfo</span> <span class="pre">*</span> <span class="pre">var</span></code></dt>
<dd>pointer to struct fb_var_screeninfo</dd>
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">list_head</span> <span class="pre">*</span> <span class="pre">head</span></code></dt>
<dd>pointer to struct list_head of modelist</dd>
</dl>
<p><strong>Return</strong></p>
<p>struct fb_videomode, NULL if none found</p>
<dl class="function">
<dt id="c.fb_add_videomode">
int <code class="descname">fb_add_videomode</code><span class="sig-paren">(</span>const struct fb_videomode *<em>&nbsp;mode</em>, struct list_head *<em>&nbsp;head</em><span class="sig-paren">)</span><a class="headerlink" href="#c.fb_add_videomode" title="Permalink to this definition">Â¶</a></dt>
<dd><p>adds videomode entry to modelist</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">fb_videomode</span> <span class="pre">*</span> <span class="pre">mode</span></code></dt>
<dd>videomode to add</dd>
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">list_head</span> <span class="pre">*</span> <span class="pre">head</span></code></dt>
<dd>struct list_head of modelist</dd>
</dl>
<p><strong>NOTES</strong></p>
<p>Will only add unmatched mode entries</p>
<dl class="function">
<dt id="c.fb_destroy_modelist">
void <code class="descname">fb_destroy_modelist</code><span class="sig-paren">(</span>struct list_head *<em>&nbsp;head</em><span class="sig-paren">)</span><a class="headerlink" href="#c.fb_destroy_modelist" title="Permalink to this definition">Â¶</a></dt>
<dd><p>destroy modelist</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">list_head</span> <span class="pre">*</span> <span class="pre">head</span></code></dt>
<dd>struct list_head of modelist</dd>
</dl>
<dl class="function">
<dt id="c.fb_videomode_to_modelist">
void <code class="descname">fb_videomode_to_modelist</code><span class="sig-paren">(</span>const struct fb_videomode *<em>&nbsp;modedb</em>, int<em>&nbsp;num</em>, struct list_head *<em>&nbsp;head</em><span class="sig-paren">)</span><a class="headerlink" href="#c.fb_videomode_to_modelist" title="Permalink to this definition">Â¶</a></dt>
<dd><p>convert mode array to mode list</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">fb_videomode</span> <span class="pre">*</span> <span class="pre">modedb</span></code></dt>
<dd>array of struct fb_videomode</dd>
<dt><code class="docutils literal"><span class="pre">int</span> <span class="pre">num</span></code></dt>
<dd>number of entries in array</dd>
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">list_head</span> <span class="pre">*</span> <span class="pre">head</span></code></dt>
<dd>struct list_head of modelist</dd>
</dl>
</div>
<div class="section" id="frame-buffer-macintosh-video-mode-database">
<h2>Frame Buffer Macintosh Video Mode Database<a class="headerlink" href="#frame-buffer-macintosh-video-mode-database" title="Permalink to this headline">Â¶</a></h2>
<dl class="function">
<dt id="c.mac_vmode_to_var">
int <code class="descname">mac_vmode_to_var</code><span class="sig-paren">(</span>int<em>&nbsp;vmode</em>, int<em>&nbsp;cmode</em>, struct fb_var_screeninfo *<em>&nbsp;var</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mac_vmode_to_var" title="Permalink to this definition">Â¶</a></dt>
<dd><p>converts vmode/cmode pair to var structure</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">int</span> <span class="pre">vmode</span></code></dt>
<dd>MacOS video mode</dd>
<dt><code class="docutils literal"><span class="pre">int</span> <span class="pre">cmode</span></code></dt>
<dd>MacOS color mode</dd>
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">fb_var_screeninfo</span> <span class="pre">*</span> <span class="pre">var</span></code></dt>
<dd>frame buffer video mode structure</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div><p>Converts a MacOS vmode/cmode pair to a frame buffer video
mode structure.</p>
<p>Returns negative errno on error, or zero for success.</p>
</div></blockquote>
<dl class="function">
<dt id="c.mac_map_monitor_sense">
int <code class="descname">mac_map_monitor_sense</code><span class="sig-paren">(</span>int<em>&nbsp;sense</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mac_map_monitor_sense" title="Permalink to this definition">Â¶</a></dt>
<dd><p>Convert monitor sense to vmode</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">int</span> <span class="pre">sense</span></code></dt>
<dd>Macintosh monitor sense number</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div><p>Converts a Macintosh monitor sense number to a MacOS
vmode number.</p>
<p>Returns MacOS vmode video mode number.</p>
</div></blockquote>
<dl class="function">
<dt id="c.mac_find_mode">
int <code class="descname">mac_find_mode</code><span class="sig-paren">(</span>struct fb_var_screeninfo *<em>&nbsp;var</em>, struct fb_info *<em>&nbsp;info</em>, const char *<em>&nbsp;mode_option</em>, unsigned int<em>&nbsp;default_bpp</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mac_find_mode" title="Permalink to this definition">Â¶</a></dt>
<dd><p>find a video mode</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">fb_var_screeninfo</span> <span class="pre">*</span> <span class="pre">var</span></code></dt>
<dd>frame buffer user defined part of display</dd>
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">fb_info</span> <span class="pre">*</span> <span class="pre">info</span></code></dt>
<dd>frame buffer info structure</dd>
<dt><code class="docutils literal"><span class="pre">const</span> <span class="pre">char</span> <span class="pre">*</span> <span class="pre">mode_option</span></code></dt>
<dd>video mode name (see mac_modedb[])</dd>
<dt><code class="docutils literal"><span class="pre">unsigned</span> <span class="pre">int</span> <span class="pre">default_bpp</span></code></dt>
<dd>default color depth in bits per pixel</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div>Finds a suitable video mode.  Tries to set mode specified
by <strong>mode_option</strong>.  If the name of the wanted mode begins with
&#8216;mac&#8217;, the Mac video mode database will be used, otherwise it
will fall back to the standard video mode database.</div></blockquote>
<p><strong>Note</strong></p>
<dl class="docutils">
<dt>Function marked as __init and can only be used during</dt>
<dd><p class="first">system boot.</p>
<p class="last">Returns error code from fb_find_mode (see fb_find_mode
function).</p>
</dd>
</dl>
</div>
<div class="section" id="frame-buffer-fonts">
<h2>Frame Buffer Fonts<a class="headerlink" href="#frame-buffer-fonts" title="Permalink to this headline">Â¶</a></h2>
<p>Refer to the file lib/fonts/fonts.c for more information.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="regulator.html" class="btn btn-neutral float-right" title="Voltage and current regulator API" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="sound.html" class="btn btn-neutral" title="Sound Devices" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>