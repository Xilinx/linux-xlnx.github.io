

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1. Introduction &mdash; The Linux Kernel  documentation</title>
  

  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
  

  
    <link rel="top" title="The Linux Kernel  documentation" href="../index.html"/>
        <link rel="up" title="Linux Input Subsystem userspace API" href="input_uapi.html"/>
        <link rel="next" title="2. Input event codes" href="event-codes.html"/>
        <link rel="prev" title="Linux Input Subsystem userspace API" href="input_uapi.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                4.19.0-xilinx-v2019.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
                <ul>
<li class="toctree-l1"><a class="reference internal" href="../process/license-rules.html">Linux kernel licensing rules</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/index.html">The Linux kernel user&#8217;s and administrator&#8217;s guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../userspace-api/index.html">The Linux kernel user-space API guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../process/index.html">Working with the kernel development community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trace/index.html">Linux Tracing Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../maintainer/index.html">Kernel Maintainer Handbook</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../driver-api/index.html">The Linux driver implementer&#8217;s API guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../media/index.html">Linux Media Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../networking/index.html">Linux Networking Documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">The Linux Input Documentation</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="input_uapi.html">Linux Input Subsystem userspace API</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="">1. Introduction</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#architecture">1.1. Architecture</a></li>
<li class="toctree-l4"><a class="reference internal" href="#simple-usage">1.2. Simple Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#detailed-description">1.3. Detailed Description</a></li>
<li class="toctree-l4"><a class="reference internal" href="#verifying-if-it-works">1.4. Verifying if it works</a></li>
<li class="toctree-l4"><a class="reference internal" href="#event-interface">1.5. Event interface</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="event-codes.html">2. Input event codes</a></li>
<li class="toctree-l3"><a class="reference internal" href="multi-touch-protocol.html">3. Multi-touch (MT) Protocol</a></li>
<li class="toctree-l3"><a class="reference internal" href="gamepad.html">4. Linux Gamepad Specification</a></li>
<li class="toctree-l3"><a class="reference internal" href="ff.html">5. Force feedback for Linux</a></li>
<li class="toctree-l3"><a class="reference internal" href="joydev/index.html">6. Linux Joystick support</a></li>
<li class="toctree-l3"><a class="reference internal" href="uinput.html">7. uinput module</a></li>
<li class="toctree-l3"><a class="reference internal" href="userio.html">8. The userio Protocol</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="input_kapi.html">Linux Input Subsystem kernel API</a></li>
<li class="toctree-l2"><a class="reference internal" href="devices/index.html">Driver-specific documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../gpu/index.html">Linux GPU Driver Developer&#8217;s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security/index.html">Security Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sound/index.html">Linux Sound Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../crypto/index.html">Linux Kernel Crypto API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../filesystems/index.html">Linux Filesystems API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../vm/index.html">Linux Memory Management Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bpf/index.html">BPF Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../misc-devices/index.html">Assorted Miscellaneous Devices Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../sh/index.html">SuperH Interfaces Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../filesystems/ext4/index.html">ext4 Filesystem</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../translations/index.html">Translations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="../index.html">The Linux Kernel</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          

 



<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Docs</a> &raquo;</li>
      
          <li><a href="index.html">The Linux Input Documentation</a> &raquo;</li>
      
          <li><a href="input_uapi.html">Linux Input Subsystem userspace API</a> &raquo;</li>
      
    <li>1. Introduction</li>
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/input/input.txt" rel="nofollow"> View page source</a>
          
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="introduction">
<h1>1. Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Copyright:</th><td class="field-body">© 1999-2001 Vojtech Pavlik &lt;<a class="reference external" href="mailto:vojtech&#37;&#52;&#48;ucw&#46;cz">vojtech<span>&#64;</span>ucw<span>&#46;</span>cz</a>&gt; - Sponsored by SuSE</td>
</tr>
</tbody>
</table>
<div class="section" id="architecture">
<h2>1.1. Architecture<a class="headerlink" href="#architecture" title="Permalink to this headline">¶</a></h2>
<p>Input subsystem  a collection of drivers that is designed to support
all input devices under Linux. Most of the drivers reside in
drivers/input, although quite a few live in drivers/hid and
drivers/platform.</p>
<p>The core of the input subsystem is the input module, which must be
loaded before any other of the input modules - it serves as a way of
communication between two groups of modules:</p>
<div class="section" id="device-drivers">
<h3>1.1.1. Device drivers<a class="headerlink" href="#device-drivers" title="Permalink to this headline">¶</a></h3>
<p>These modules talk to the hardware (for example via USB), and provide
events (keystrokes, mouse movements) to the input module.</p>
</div>
<div class="section" id="event-handlers">
<h3>1.1.2. Event handlers<a class="headerlink" href="#event-handlers" title="Permalink to this headline">¶</a></h3>
<p>These modules get events from input core and pass them where needed
via various interfaces - keystrokes to the kernel, mouse movements via
a simulated PS/2 interface to GPM and X, and so on.</p>
</div>
</div>
<div class="section" id="simple-usage">
<h2>1.2. Simple Usage<a class="headerlink" href="#simple-usage" title="Permalink to this headline">¶</a></h2>
<p>For the most usual configuration, with one USB mouse and one USB keyboard,
you&#8217;ll have to load the following modules (or have them built in to the
kernel):</p>
<div class="highlight-none"><div class="highlight"><pre>input
mousedev
usbcore
uhci_hcd or ohci_hcd or ehci_hcd
usbhid
hid_generic
</pre></div>
</div>
<p>After this, the USB keyboard will work straight away, and the USB mouse
will be available as a character device on major 13, minor 63:</p>
<div class="highlight-none"><div class="highlight"><pre>crw-r--r--   1 root     root      13,  63 Mar 28 22:45 mice
</pre></div>
</div>
<p>This device usually created automatically by the system. The commands
to create it by hand are:</p>
<div class="highlight-none"><div class="highlight"><pre>cd /dev
mkdir input
mknod input/mice c 13 63
</pre></div>
</div>
<p>After that you have to point GPM (the textmode mouse cut&amp;paste tool) and
XFree to this device to use it - GPM should be called like:</p>
<div class="highlight-none"><div class="highlight"><pre>gpm -t ps2 -m /dev/input/mice
</pre></div>
</div>
<p>And in X:</p>
<div class="highlight-none"><div class="highlight"><pre>Section &quot;Pointer&quot;
    Protocol    &quot;ImPS/2&quot;
    Device      &quot;/dev/input/mice&quot;
    ZAxisMapping 4 5
EndSection
</pre></div>
</div>
<p>When you do all of the above, you can use your USB mouse and keyboard.</p>
</div>
<div class="section" id="detailed-description">
<h2>1.3. Detailed Description<a class="headerlink" href="#detailed-description" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>1.3.1. Event handlers<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>Event handlers distribute the events from the devices to userspace and
in-kernel consumers, as needed.</p>
<div class="section" id="evdev">
<h4>1.3.1.1. evdev<a class="headerlink" href="#evdev" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal"><span class="pre">evdev</span></code> is the generic input event interface. It passes the events
generated in the kernel straight to the program, with timestamps. The
event codes are the same on all architectures and are hardware
independent.</p>
<p>This is the preferred interface for userspace to consume user
input, and all clients are encouraged to use it.</p>
<p>See <a class="reference internal" href="#event-interface"><span>Event interface</span></a> for notes on API.</p>
<p>The devices are in /dev/input:</p>
<div class="highlight-none"><div class="highlight"><pre>crw-r--r--   1 root     root      13,  64 Apr  1 10:49 event0
crw-r--r--   1 root     root      13,  65 Apr  1 10:50 event1
crw-r--r--   1 root     root      13,  66 Apr  1 10:50 event2
crw-r--r--   1 root     root      13,  67 Apr  1 10:50 event3
...
</pre></div>
</div>
<p>There are two ranges of minors: 64 through 95 is the static legacy
range. If there are more than 32 input devices in a system, additional
evdev nodes are created with minors starting with 256.</p>
</div>
<div class="section" id="keyboard">
<h4>1.3.1.2. keyboard<a class="headerlink" href="#keyboard" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal"><span class="pre">keyboard</span></code> is in-kernel input handler and is a part of VT code. It
consumes keyboard keystrokes and handles user input for VT consoles.</p>
</div>
<div class="section" id="mousedev">
<h4>1.3.1.3. mousedev<a class="headerlink" href="#mousedev" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal"><span class="pre">mousedev</span></code> is a hack to make legacy programs that use mouse input
work. It takes events from either mice or digitizers/tablets and makes
a PS/2-style (a la /dev/psaux) mouse device available to the
userland.</p>
<p>Mousedev devices in /dev/input (as shown above) are:</p>
<div class="highlight-none"><div class="highlight"><pre>crw-r--r--   1 root     root      13,  32 Mar 28 22:45 mouse0
crw-r--r--   1 root     root      13,  33 Mar 29 00:41 mouse1
crw-r--r--   1 root     root      13,  34 Mar 29 00:41 mouse2
crw-r--r--   1 root     root      13,  35 Apr  1 10:50 mouse3
...
...
crw-r--r--   1 root     root      13,  62 Apr  1 10:50 mouse30
crw-r--r--   1 root     root      13,  63 Apr  1 10:50 mice
</pre></div>
</div>
<p>Each <code class="docutils literal"><span class="pre">mouse</span></code> device is assigned to a single mouse or digitizer, except
the last one - <code class="docutils literal"><span class="pre">mice</span></code>. This single character device is shared by all
mice and digitizers, and even if none are connected, the device is
present.  This is useful for hotplugging USB mice, so that older programs
that do not handle hotplug can open the device even when no mice are
present.</p>
<p>CONFIG_INPUT_MOUSEDEV_SCREEN_[XY] in the kernel configuration are
the size of your screen (in pixels) in XFree86. This is needed if you
want to use your digitizer in X, because its movement is sent to X
via a virtual PS/2 mouse and thus needs to be scaled
accordingly. These values won&#8217;t be used if you use a mouse only.</p>
<p>Mousedev will generate either PS/2, ImPS/2 (Microsoft IntelliMouse) or
ExplorerPS/2 (IntelliMouse Explorer) protocols, depending on what the
program reading the data wishes. You can set GPM and X to any of
these. You&#8217;ll need ImPS/2 if you want to make use of a wheel on a USB
mouse and ExplorerPS/2 if you want to use extra (up to 5) buttons.</p>
</div>
<div class="section" id="joydev">
<h4>1.3.1.4. joydev<a class="headerlink" href="#joydev" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal"><span class="pre">joydev</span></code> implements v0.x and v1.x Linux joystick API. See
<a class="reference internal" href="joydev/joystick-api.html#joystick-api"><span>Programming Interface</span></a> for details.</p>
<p>As soon as any joystick is connected, it can be accessed in /dev/input on:</p>
<div class="highlight-none"><div class="highlight"><pre>crw-r--r--   1 root     root      13,   0 Apr  1 10:50 js0
crw-r--r--   1 root     root      13,   1 Apr  1 10:50 js1
crw-r--r--   1 root     root      13,   2 Apr  1 10:50 js2
crw-r--r--   1 root     root      13,   3 Apr  1 10:50 js3
...
</pre></div>
</div>
<p>And so on up to js31 in legacy range, and additional nodes with minors
above 256 if there are more joystick devices.</p>
</div>
</div>
<div class="section" id="id2">
<h3>1.3.2. Device drivers<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<p>Device drivers are the modules that generate events.</p>
<div class="section" id="hid-generic">
<h4>1.3.2.1. hid-generic<a class="headerlink" href="#hid-generic" title="Permalink to this headline">¶</a></h4>
<p><code class="docutils literal"><span class="pre">hid-generic</span></code> is one of the largest and most complex driver of the
whole suite. It handles all HID devices, and because there is a very
wide variety of them, and because the USB HID specification isn&#8217;t
simple, it needs to be this big.</p>
<p>Currently, it handles USB mice, joysticks, gamepads, steering wheels
keyboards, trackballs and digitizers.</p>
<p>However, USB uses HID also for monitor controls, speaker controls, UPSs,
LCDs and many other purposes.</p>
<p>The monitor and speaker controls should be easy to add to the hid/input
interface, but for the UPSs and LCDs it doesn&#8217;t make much sense. For this,
the hiddev interface was designed. See Documentation/hid/hiddev.txt
for more information about it.</p>
<p>The usage of the usbhid module is very simple, it takes no parameters,
detects everything automatically and when a HID device is inserted, it
detects it appropriately.</p>
<p>However, because the devices vary wildly, you might happen to have a
device that doesn&#8217;t work well. In that case #define DEBUG at the beginning
of hid-core.c and send me the syslog traces.</p>
</div>
<div class="section" id="usbmouse">
<h4>1.3.2.2. usbmouse<a class="headerlink" href="#usbmouse" title="Permalink to this headline">¶</a></h4>
<p>For embedded systems, for mice with broken HID descriptors and just any
other use when the big usbhid wouldn&#8217;t be a good choice, there is the
usbmouse driver. It handles USB mice only. It uses a simpler HIDBP
protocol. This also means the mice must support this simpler protocol. Not
all do. If you don&#8217;t have any strong reason to use this module, use usbhid
instead.</p>
</div>
<div class="section" id="usbkbd">
<h4>1.3.2.3. usbkbd<a class="headerlink" href="#usbkbd" title="Permalink to this headline">¶</a></h4>
<p>Much like usbmouse, this module talks to keyboards with a simplified
HIDBP protocol. It&#8217;s smaller, but doesn&#8217;t support any extra special keys.
Use usbhid instead if there isn&#8217;t any special reason to use this.</p>
</div>
<div class="section" id="psmouse">
<h4>1.3.2.4. psmouse<a class="headerlink" href="#psmouse" title="Permalink to this headline">¶</a></h4>
<p>This is driver for all flavors of pointing devices using PS/2
protocol, including Synaptics and ALPS touchpads, Intellimouse
Explorer devices, Logitech PS/2 mice and so on.</p>
</div>
<div class="section" id="atkbd">
<h4>1.3.2.5. atkbd<a class="headerlink" href="#atkbd" title="Permalink to this headline">¶</a></h4>
<p>This is driver for PS/2 (AT) keyboards.</p>
</div>
<div class="section" id="iforce">
<h4>1.3.2.6. iforce<a class="headerlink" href="#iforce" title="Permalink to this headline">¶</a></h4>
<p>A driver for I-Force joysticks and wheels, both over USB and RS232.
It includes Force Feedback support now, even though Immersion
Corp. considers the protocol a trade secret and won&#8217;t disclose a word
about it.</p>
</div>
</div>
</div>
<div class="section" id="verifying-if-it-works">
<h2>1.4. Verifying if it works<a class="headerlink" href="#verifying-if-it-works" title="Permalink to this headline">¶</a></h2>
<p>Typing a couple keys on the keyboard should be enough to check that
a keyboard works and is correctly connected to the kernel keyboard
driver.</p>
<p>Doing a <code class="docutils literal"><span class="pre">cat</span> <span class="pre">/dev/input/mouse0</span></code> (c, 13, 32) will verify that a mouse
is also emulated; characters should appear if you move it.</p>
<p>You can test the joystick emulation with the <code class="docutils literal"><span class="pre">jstest</span></code> utility,
available in the joystick package (see <a class="reference internal" href="joydev/joystick.html#joystick-doc"><span>Introduction</span></a>).</p>
<p>You can test the event devices with the <code class="docutils literal"><span class="pre">evtest</span></code> utility.</p>
</div>
<div class="section" id="event-interface">
<span id="id3"></span><h2>1.5. Event interface<a class="headerlink" href="#event-interface" title="Permalink to this headline">¶</a></h2>
<p>You can use blocking and nonblocking reads, and also select() on the
/dev/input/eventX devices, and you&#8217;ll always get a whole number of input
events on a read. Their layout is:</p>
<div class="highlight-none"><div class="highlight"><pre>struct input_event {
        struct timeval time;
        unsigned short type;
        unsigned short code;
        unsigned int value;
};
</pre></div>
</div>
<p><code class="docutils literal"><span class="pre">time</span></code> is the timestamp, it returns the time at which the event happened.
Type is for example EV_REL for relative moment, EV_KEY for a keypress or
release. More types are defined in include/uapi/linux/input-event-codes.h.</p>
<p><code class="docutils literal"><span class="pre">code</span></code> is event code, for example REL_X or KEY_BACKSPACE, again a complete
list is in include/uapi/linux/input-event-codes.h.</p>
<p><code class="docutils literal"><span class="pre">value</span></code> is the value the event carries. Either a relative change for
EV_REL, absolute new value for EV_ABS (joysticks ...), or 0 for EV_KEY for
release, 1 for keypress and 2 for autorepeat.</p>
<p>See <a class="reference internal" href="event-codes.html#input-event-codes"><span>Input event codes</span></a> for more information about various even codes.</p>
</div>
</div>


           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="event-codes.html" class="btn btn-neutral float-right" title="2. Input event codes" accesskey="n">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="input_uapi.html" class="btn btn-neutral" title="Linux Input Subsystem userspace API" accesskey="p"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="../_static/jquery.js"></script>
      <script type="text/javascript" src="../_static/underscore.js"></script>
      <script type="text/javascript" src="../_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>