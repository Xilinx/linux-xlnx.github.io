

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Xilinx SD-FEC Driver &mdash; The Linux Kernel  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                4.14.0-xilinx-v2018.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/index.html">The Linux kernel user’s and administrator’s guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../userspace-api/index.html">The Linux kernel user-space API guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../process/index.html">Working with the kernel development community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../driver-api/index.html">The Linux driver implementer’s API guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../media/index.html">Linux Media Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../networking/index.html">Linux Networking Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input/index.html">The Linux Input Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu/index.html">Linux GPU Driver Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security/index.html">Security Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sound/index.html">Linux Sound Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../crypto/index.html">Linux Kernel Crypto API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../filesystems/index.html">Linux Filesystems API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../sh/index.html">SuperH Interfaces Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../translations/ko_KR/index.html">Korean translations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../translations/zh_CN/index.html">Chinese translations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../translations/ja_JP/index.html">Japanese translations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Xilinx SD-FEC Driver</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/misc-devices/xilinx_sdfec.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="xilinx-sd-fec-driver">
<h1>Xilinx SD-FEC Driver<a class="headerlink" href="#xilinx-sd-fec-driver" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
<p class="caption"><span class="caption-text">Table of Contents</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Xilinx SD-FEC Driver</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#modes-of-operation">Modes of Operation</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#run-time-configuration">Run-time Configuration</a></li>
<li class="toctree-l4"><a class="reference internal" href="#programmable-logic-pl-initialization">Programmable Logic (PL) Initialization</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#driver-structure">Driver Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#driver-usage">Driver Usage</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id1">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#determine-configuration">Determine Configuration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#set-the-order">Set the Order</a></li>
<li class="toctree-l3"><a class="reference internal" href="#add-ldpc-codes">Add LDPC Codes</a></li>
<li class="toctree-l3"><a class="reference internal" href="#set-turbo-decode">Set Turbo Decode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#enable-interrupts">Enable Interrupts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#bypass-the-sd-fec">Bypass the SD-FEC</a></li>
<li class="toctree-l3"><a class="reference internal" href="#start-the-sd-fec-core">Start the SD-FEC core</a></li>
<li class="toctree-l3"><a class="reference internal" href="#get-sd-fec-status">Get SD-FEC Status</a></li>
<li class="toctree-l3"><a class="reference internal" href="#monitor-for-interrupts">Monitor for Interrupts</a></li>
<li class="toctree-l3"><a class="reference internal" href="#stop-the-sd-fec-core">Stop the SD-FEC Core</a></li>
<li class="toctree-l3"><a class="reference internal" href="#set-the-default-configuration">Set the Default Configuration</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#driver-ioctls">Driver IOCTLs</a></li>
<li class="toctree-l2"><a class="reference internal" href="#driver-type-definitions">Driver Type Definitions</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This driver supports SD-FEC Integrated Block for Zynq Ultrascale+™ RFSoCs.</p>
<p>For a full description of SD-FEC core features, see the <a class="reference external" href="https://www.xilinx.com/cgi-bin/docs/ipdoc?c=sd_fec;v=latest;d=pg256-sdfec-integrated-block.pdf">SD-FEC Product Guide (PG256)</a></p>
<p>This driver supports the following features:</p>
<blockquote>
<div><ul class="simple">
<li>Retrieval of the Integrated Block configuration and status information</li>
<li>Configuration of LDPC codes</li>
<li>Configuration of Turbo decoding</li>
<li>Monitoring errors</li>
</ul>
</div></blockquote>
<p>Missing features, known issues, and limitations of the SD-FEC driver are as
follows:</p>
<blockquote>
<div><ul class="simple">
<li>Only allows a single open file handler to any instance of the driver at any time</li>
<li>Reset of the SD-FEC Integrated Block is not controlled by this driver</li>
<li>Does not support shared LDPC code table wraparound</li>
</ul>
</div></blockquote>
<p>The device tree entry is described in:
<a class="reference external" href="https://github.com/Xilinx/linux-xlnx/blob/master/Documentation/devicetree/bindings/misc/xlnx%2Csd-fec.txt">linux-xlnx/Documentation/devicetree/bindings/misc/xlnx,sd-fec.txt</a></p>
<div class="section" id="modes-of-operation">
<h3>Modes of Operation<a class="headerlink" href="#modes-of-operation" title="Permalink to this headline">¶</a></h3>
<p>The driver works with the SD-FEC core in two modes of operation:</p>
<blockquote>
<div><ul class="simple">
<li>Run-time configuration</li>
<li>Programmable Logic (PL) initialization</li>
</ul>
</div></blockquote>
<div class="section" id="run-time-configuration">
<h4>Run-time Configuration<a class="headerlink" href="#run-time-configuration" title="Permalink to this headline">¶</a></h4>
<p>For Run-time configuration the role of driver is to allow the software application to do the following:</p>
<blockquote>
<div><ul class="simple">
<li>Load the configuration parameters for either Turbo decode or LDPC encode or decode</li>
<li>Activate the SD-FEC core</li>
<li>Monitor the SD-FEC core for errors</li>
<li>Retrieve the status and configuration of the SD-FEC core</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="programmable-logic-pl-initialization">
<h4>Programmable Logic (PL) Initialization<a class="headerlink" href="#programmable-logic-pl-initialization" title="Permalink to this headline">¶</a></h4>
<p>For PL initialization, supporting logic loads configuration parameters for either
the Turbo decode or LDPC encode or decode.  The role of the driver is to allow
the software application to do the following:</p>
<blockquote>
<div><ul class="simple">
<li>Activate the SD-FEC core</li>
<li>Monitor the SD-FEC core for errors</li>
<li>Retrieve the status and configuration of the SD-FEC core</li>
</ul>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="driver-structure">
<h2>Driver Structure<a class="headerlink" href="#driver-structure" title="Permalink to this headline">¶</a></h2>
<p>The driver provides a platform device where the <code class="docutils literal"><span class="pre">probe</span></code> and <code class="docutils literal"><span class="pre">remove</span></code>
operations are provided.</p>
<blockquote>
<div><ul class="simple">
<li>probe: Updates configuration register with device-tree entries plus determines the current activate state of the core, for example, is the core bypassed or has the core been started.</li>
</ul>
</div></blockquote>
<p>The driver defines the following driver file operations to provide user
application interfaces:</p>
<blockquote>
<div><ul>
<li><p class="first">open: Implements restriction that only a single file descriptor can be open per SD-FEC instance at any time</p>
</li>
<li><p class="first">release: Allows another file descriptor to be open, that is after current file descriptor is closed</p>
</li>
<li><p class="first">poll: Provides a method to monitor for SD-FEC Error events</p>
</li>
<li><p class="first">unlocked_ioctl: Provides the the following ioctl commands that allows the application configure the SD-FEC core:</p>
<blockquote>
<div><ul class="simple">
<li><a class="reference internal" href="#c.XSDFEC_START_DEV" title="XSDFEC_START_DEV"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_START_DEV</span></code></a></li>
<li><a class="reference internal" href="#c.XSDFEC_STOP_DEV" title="XSDFEC_STOP_DEV"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_STOP_DEV</span></code></a></li>
<li><a class="reference internal" href="#c.XSDFEC_GET_STATUS" title="XSDFEC_GET_STATUS"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_GET_STATUS</span></code></a></li>
<li><a class="reference internal" href="#c.XSDFEC_SET_IRQ" title="XSDFEC_SET_IRQ"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_SET_IRQ</span></code></a></li>
<li><a class="reference internal" href="#c.XSDFEC_SET_TURBO" title="XSDFEC_SET_TURBO"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_SET_TURBO</span></code></a></li>
<li><a class="reference internal" href="#c.XSDFEC_ADD_LDPC_CODE_PARAMS" title="XSDFEC_ADD_LDPC_CODE_PARAMS"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_ADD_LDPC_CODE_PARAMS</span></code></a></li>
<li><a class="reference internal" href="#c.XSDFEC_GET_CONFIG" title="XSDFEC_GET_CONFIG"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_GET_CONFIG</span></code></a></li>
<li><a class="reference internal" href="#c.XSDFEC_SET_ORDER" title="XSDFEC_SET_ORDER"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_SET_ORDER</span></code></a></li>
<li><a class="reference internal" href="#c.XSDFEC_SET_BYPASS" title="XSDFEC_SET_BYPASS"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_SET_BYPASS</span></code></a></li>
<li><a class="reference internal" href="#c.XSDFEC_IS_ACTIVE" title="XSDFEC_IS_ACTIVE"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_IS_ACTIVE</span></code></a></li>
<li><a class="reference internal" href="#c.XSDFEC_CLEAR_STATS" title="XSDFEC_CLEAR_STATS"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_CLEAR_STATS</span></code></a></li>
<li><a class="reference internal" href="#c.XSDFEC_SET_DEFAULT_CONFIG" title="XSDFEC_SET_DEFAULT_CONFIG"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_SET_DEFAULT_CONFIG</span></code></a></li>
</ul>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="driver-usage">
<h2>Driver Usage<a class="headerlink" href="#driver-usage" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3>Overview<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>After opening the driver, the user should find out what operations need to be
performed to configure and activate the SD-FEC core and determine the
configuration of the driver.
The following outlines the flow the user should perform:</p>
<blockquote>
<div><ul class="simple">
<li>Determine Configuration</li>
<li>Set the order, if not already configured as desired</li>
<li>Set Turbo decode, LPDC encode or decode parameters, depending on how the
SD-FEC core is configured plus if the SD-FEC has not been configured for PL
initialization</li>
<li>Enable interrupts, if not already enabled</li>
<li>Bypass the SD-FEC core, if required</li>
<li>Start the SD-FEC core if not already started</li>
<li>Get the SD-FEC core status</li>
<li>Monitor for interrupts</li>
<li>Stop the SD-FEC core</li>
</ul>
</div></blockquote>
<p>Note: When monitoring for interrupts if a critical error is detected where a reset is required, the driver will be required to load the default configuration.</p>
</div>
<div class="section" id="determine-configuration">
<h3>Determine Configuration<a class="headerlink" href="#determine-configuration" title="Permalink to this headline">¶</a></h3>
<p>Determine the configuration of the SD-FEC core by using the ioctl
<a class="reference internal" href="#c.XSDFEC_GET_CONFIG" title="XSDFEC_GET_CONFIG"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_GET_CONFIG</span></code></a>.</p>
</div>
<div class="section" id="set-the-order">
<h3>Set the Order<a class="headerlink" href="#set-the-order" title="Permalink to this headline">¶</a></h3>
<p>Setting the order determines how the order of Blocks can change from input to output.</p>
<p>Setting the order is done by using the ioctl <a class="reference internal" href="#c.XSDFEC_SET_ORDER" title="XSDFEC_SET_ORDER"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_SET_ORDER</span></code></a></p>
<p>Setting the order can only be done if the following restrictions are met:</p>
<blockquote>
<div><ul class="simple">
<li>The <code class="docutils literal"><span class="pre">state</span></code> member of struct <a class="reference internal" href="#c.xsdfec_status" title="xsdfec_status"><code class="xref c c-type docutils literal"><span class="pre">xsdfec_status</span></code></a> filled by the ioctl <a class="reference internal" href="#c.XSDFEC_GET_STATUS" title="XSDFEC_GET_STATUS"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_GET_STATUS</span></code></a> indicates the SD-FEC core has not STARTED</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="add-ldpc-codes">
<h3>Add LDPC Codes<a class="headerlink" href="#add-ldpc-codes" title="Permalink to this headline">¶</a></h3>
<p>The following steps indicate how to add LDPC codes to the SD-FEC core:</p>
<blockquote>
<div><ul class="simple">
<li>Use the auto-generated parameters to fill the <a class="reference internal" href="#c.xsdfec_ldpc_params" title="xsdfec_ldpc_params"><code class="xref c c-type docutils literal"><span class="pre">struct</span> <span class="pre">xsdfec_ldpc_params</span></code></a> for the desired LDPC code.</li>
<li>Set the SC, QA, and LA table offsets for the LPDC parameters and the parameters in the structure <a class="reference internal" href="#c.xsdfec_ldpc_params" title="xsdfec_ldpc_params"><code class="xref c c-type docutils literal"><span class="pre">struct</span> <span class="pre">xsdfec_ldpc_params</span></code></a></li>
<li>Set the desired Code Id value in the structure <a class="reference internal" href="#c.xsdfec_ldpc_params" title="xsdfec_ldpc_params"><code class="xref c c-type docutils literal"><span class="pre">struct</span> <span class="pre">xsdfec_ldpc_params</span></code></a></li>
<li>Add the LPDC Code Parameters using the ioctl <a class="reference internal" href="#c.XSDFEC_ADD_LDPC_CODE_PARAMS" title="XSDFEC_ADD_LDPC_CODE_PARAMS"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_ADD_LDPC_CODE_PARAMS</span></code></a></li>
<li>For the applied LPDC Code Parameter use the function <a class="reference internal" href="#c.xsdfec_calculate_shared_ldpc_table_entry_size" title="xsdfec_calculate_shared_ldpc_table_entry_size"><code class="xref c c-func docutils literal"><span class="pre">xsdfec_calculate_shared_ldpc_table_entry_size()</span></code></a> to calculate the size of shared LPDC code tables. This allows the user to determine the shared table usage so when selecting the table offsets for the next LDPC code parameters unused table areas can be selected.</li>
<li>Repeat for each LDPC code parameter.</li>
</ul>
</div></blockquote>
<p>Adding LDPC codes can only be done if the following restrictions are met:</p>
<blockquote>
<div><ul class="simple">
<li>The <code class="docutils literal"><span class="pre">code</span></code> member of <a class="reference internal" href="#c.xsdfec_config" title="xsdfec_config"><code class="xref c c-type docutils literal"><span class="pre">struct</span> <span class="pre">xsdfec_config</span></code></a> filled by the ioctl <a class="reference internal" href="#c.XSDFEC_GET_CONFIG" title="XSDFEC_GET_CONFIG"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_GET_CONFIG</span></code></a> indicates the SD-FEC core is configured as LDPC</li>
<li>The <code class="docutils literal"><span class="pre">code_wr_protect</span></code> of <a class="reference internal" href="#c.xsdfec_config" title="xsdfec_config"><code class="xref c c-type docutils literal"><span class="pre">struct</span> <span class="pre">xsdfec_config</span></code></a> filled by the ioctl <a class="reference internal" href="#c.XSDFEC_GET_CONFIG" title="XSDFEC_GET_CONFIG"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_GET_CONFIG</span></code></a> indicates that write protection is not enabled</li>
<li>The <code class="docutils literal"><span class="pre">state</span></code> member of struct <a class="reference internal" href="#c.xsdfec_status" title="xsdfec_status"><code class="xref c c-type docutils literal"><span class="pre">xsdfec_status</span></code></a> filled by the ioctl <a class="reference internal" href="#c.XSDFEC_GET_STATUS" title="XSDFEC_GET_STATUS"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_GET_STATUS</span></code></a> indicates the SD-FEC core has not started</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="set-turbo-decode">
<h3>Set Turbo Decode<a class="headerlink" href="#set-turbo-decode" title="Permalink to this headline">¶</a></h3>
<p>Configuring the Turbo decode parameters is done by using the ioctl <a class="reference internal" href="#c.XSDFEC_SET_TURBO" title="XSDFEC_SET_TURBO"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_SET_TURBO</span></code></a> using auto-generated parameters to fill the <a class="reference internal" href="#c.xsdfec_turbo" title="xsdfec_turbo"><code class="xref c c-type docutils literal"><span class="pre">struct</span> <span class="pre">xsdfec_turbo</span></code></a> for the desired Turbo code.</p>
<p>Adding Turbo decode can only be done if the following restrictions are met:</p>
<blockquote>
<div><ul class="simple">
<li>The <code class="docutils literal"><span class="pre">code</span></code> member of <a class="reference internal" href="#c.xsdfec_config" title="xsdfec_config"><code class="xref c c-type docutils literal"><span class="pre">struct</span> <span class="pre">xsdfec_config</span></code></a> filled by the ioctl <a class="reference internal" href="#c.XSDFEC_GET_CONFIG" title="XSDFEC_GET_CONFIG"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_GET_CONFIG</span></code></a> indicates the SD-FEC core is configured as TURBO</li>
<li>The <code class="docutils literal"><span class="pre">state</span></code> member of struct <a class="reference internal" href="#c.xsdfec_status" title="xsdfec_status"><code class="xref c c-type docutils literal"><span class="pre">xsdfec_status</span></code></a> filled by the ioctl <a class="reference internal" href="#c.XSDFEC_GET_STATUS" title="XSDFEC_GET_STATUS"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_GET_STATUS</span></code></a> indicates the SD-FEC core has not STARTED</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="enable-interrupts">
<h3>Enable Interrupts<a class="headerlink" href="#enable-interrupts" title="Permalink to this headline">¶</a></h3>
<p>Enabling or disabling interrupts is done by using the ioctl <a class="reference internal" href="#c.XSDFEC_SET_IRQ" title="XSDFEC_SET_IRQ"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_SET_IRQ</span></code></a>. The members of the parameter passed, <a class="reference internal" href="#c.xsdfec_irq" title="xsdfec_irq"><code class="xref c c-type docutils literal"><span class="pre">struct</span> <span class="pre">xsdfec_irq</span></code></a>, to the ioctl are used to set and clear different categories of interrupts. The category of interrupt is controlled as following:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">enable_isr</span></code> controls the <code class="docutils literal"><span class="pre">tlast</span></code> interrupts</li>
<li><code class="docutils literal"><span class="pre">enable_ecc_isr</span></code> controls the ECC interrupts</li>
</ul>
</div></blockquote>
<p>If the <code class="docutils literal"><span class="pre">code</span></code> member of <a class="reference internal" href="#c.xsdfec_config" title="xsdfec_config"><code class="xref c c-type docutils literal"><span class="pre">struct</span> <span class="pre">xsdfec_config</span></code></a> filled by the ioctl <a class="reference internal" href="#c.XSDFEC_GET_CONFIG" title="XSDFEC_GET_CONFIG"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_GET_CONFIG</span></code></a> indicates the SD-FEC core is configured as TURBO then the enabling ECC errors is not required.</p>
</div>
<div class="section" id="bypass-the-sd-fec">
<h3>Bypass the SD-FEC<a class="headerlink" href="#bypass-the-sd-fec" title="Permalink to this headline">¶</a></h3>
<p>Bypassing the SD-FEC is done by using the ioctl <a class="reference internal" href="#c.XSDFEC_SET_BYPASS" title="XSDFEC_SET_BYPASS"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_SET_BYPASS</span></code></a></p>
<p>Bypassing the SD-FEC can only be done if the following restrictions are met:</p>
<blockquote>
<div><ul class="simple">
<li>The <code class="docutils literal"><span class="pre">state</span></code> member of <a class="reference internal" href="#c.xsdfec_status" title="xsdfec_status"><code class="xref c c-type docutils literal"><span class="pre">struct</span> <span class="pre">xsdfec_status</span></code></a> filled by the ioctl <a class="reference internal" href="#c.XSDFEC_GET_STATUS" title="XSDFEC_GET_STATUS"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_GET_STATUS</span></code></a> indicates the SD-FEC core has not STARTED</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="start-the-sd-fec-core">
<h3>Start the SD-FEC core<a class="headerlink" href="#start-the-sd-fec-core" title="Permalink to this headline">¶</a></h3>
<p>Start the SD-FEC core by using the ioctl <a class="reference internal" href="#c.XSDFEC_START_DEV" title="XSDFEC_START_DEV"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_START_DEV</span></code></a></p>
</div>
<div class="section" id="get-sd-fec-status">
<h3>Get SD-FEC Status<a class="headerlink" href="#get-sd-fec-status" title="Permalink to this headline">¶</a></h3>
<p>Get the SD-FEC status of the device by using the ioctl <a class="reference internal" href="#c.XSDFEC_GET_STATUS" title="XSDFEC_GET_STATUS"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_GET_STATUS</span></code></a>, which will fill the <a class="reference internal" href="#c.xsdfec_status" title="xsdfec_status"><code class="xref c c-type docutils literal"><span class="pre">struct</span> <span class="pre">xsdfec_status</span></code></a></p>
</div>
<div class="section" id="monitor-for-interrupts">
<h3>Monitor for Interrupts<a class="headerlink" href="#monitor-for-interrupts" title="Permalink to this headline">¶</a></h3>
<blockquote>
<div><ul class="simple">
<li>Use the poll system call to monitor for an interrupt. The poll system call waits for an interrupt to wake it up or times out if no interrupt occurs.</li>
<li><dl class="first docutils">
<dt>On return Poll <code class="docutils literal"><span class="pre">revents</span></code> will indicate whether stats and/or state have been updated</dt>
<dd><ul class="first last">
<li><code class="docutils literal"><span class="pre">POLLPRI</span></code> indicates a critical error and the user should use <a class="reference internal" href="#c.XSDFEC_GET_STATUS" title="XSDFEC_GET_STATUS"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_GET_STATUS</span></code></a> and <a class="reference internal" href="#c.XSDFEC_GET_STATS" title="XSDFEC_GET_STATS"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_GET_STATS</span></code></a> to confirm</li>
<li><code class="docutils literal"><span class="pre">POLLRDNORM</span></code> indicates a non-critical error has occurred and the user should use  <a class="reference internal" href="#c.XSDFEC_GET_STATS" title="XSDFEC_GET_STATS"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_GET_STATS</span></code></a> to confirm</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Get stats by using the ioctl <a class="reference internal" href="#c.XSDFEC_GET_STATS" title="XSDFEC_GET_STATS"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_GET_STATS</span></code></a></dt>
<dd><ul class="first last">
<li>For critical error the <code class="docutils literal"><span class="pre">isr_err_count</span></code> or <code class="docutils literal"><span class="pre">uecc_count</span></code> member  of <a class="reference internal" href="#c.xsdfec_stats" title="xsdfec_stats"><code class="xref c c-type docutils literal"><span class="pre">struct</span> <span class="pre">xsdfec_stats</span></code></a> is non-zero</li>
<li>For non-critical errors the <code class="docutils literal"><span class="pre">cecc_count</span></code> member of <a class="reference internal" href="#c.xsdfec_stats" title="xsdfec_stats"><code class="xref c c-type docutils literal"><span class="pre">struct</span> <span class="pre">xsdfec_stats</span></code></a> is non-zero</li>
</ul>
</dd>
</dl>
</li>
<li><dl class="first docutils">
<dt>Get state by using the ioctl <a class="reference internal" href="#c.XSDFEC_GET_STATUS" title="XSDFEC_GET_STATUS"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_GET_STATUS</span></code></a></dt>
<dd><ul class="first last">
<li>For a critical error the <code class="docutils literal"><span class="pre">state</span></code> of <a class="reference internal" href="#c.xsdfec_status" title="xsdfec_status"><code class="xref c c-type docutils literal"><span class="pre">xsdfec_status</span></code></a> will indicate a Reset Is Required</li>
</ul>
</dd>
</dl>
</li>
<li>Clear stats by using the ioctl <a class="reference internal" href="#c.XSDFEC_CLEAR_STATS" title="XSDFEC_CLEAR_STATS"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_CLEAR_STATS</span></code></a></li>
</ul>
</div></blockquote>
<p>If a critical error is detected where a reset is required. The application is required to call the ioctl <a class="reference internal" href="#c.XSDFEC_SET_DEFAULT_CONFIG" title="XSDFEC_SET_DEFAULT_CONFIG"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_SET_DEFAULT_CONFIG</span></code></a>, after the reset and it is not required to call the ioctl <a class="reference internal" href="#c.XSDFEC_STOP_DEV" title="XSDFEC_STOP_DEV"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_STOP_DEV</span></code></a></p>
<p>Note: Using poll system call prevents busy looping using <a class="reference internal" href="#c.XSDFEC_GET_STATS" title="XSDFEC_GET_STATS"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_GET_STATS</span></code></a> and <a class="reference internal" href="#c.XSDFEC_GET_STATUS" title="XSDFEC_GET_STATUS"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_GET_STATUS</span></code></a></p>
</div>
<div class="section" id="stop-the-sd-fec-core">
<h3>Stop the SD-FEC Core<a class="headerlink" href="#stop-the-sd-fec-core" title="Permalink to this headline">¶</a></h3>
<p>Stop the device by using the ioctl <a class="reference internal" href="#c.XSDFEC_STOP_DEV" title="XSDFEC_STOP_DEV"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_STOP_DEV</span></code></a></p>
</div>
<div class="section" id="set-the-default-configuration">
<h3>Set the Default Configuration<a class="headerlink" href="#set-the-default-configuration" title="Permalink to this headline">¶</a></h3>
<p>Load default configuration by using the ioctl <a class="reference internal" href="#c.XSDFEC_SET_DEFAULT_CONFIG" title="XSDFEC_SET_DEFAULT_CONFIG"><code class="xref c c-macro docutils literal"><span class="pre">XSDFEC_SET_DEFAULT_CONFIG</span></code></a> to restore the driver.</p>
</div>
</div>
<div class="section" id="driver-ioctls">
<h2>Driver IOCTLs<a class="headerlink" href="#driver-ioctls" title="Permalink to this headline">¶</a></h2>
<dl class="macro">
<dt id="c.XSDFEC_START_DEV">
<code class="descname">XSDFEC_START_DEV</code><a class="headerlink" href="#c.XSDFEC_START_DEV" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><strong>Description</strong></p>
<p>ioctl to start SD-FEC core</p>
<p>This fails if the XSDFEC_SET_ORDER ioctl has not been previously called</p>
<dl class="macro">
<dt id="c.XSDFEC_STOP_DEV">
<code class="descname">XSDFEC_STOP_DEV</code><a class="headerlink" href="#c.XSDFEC_STOP_DEV" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><strong>Description</strong></p>
<p>ioctl to stop the SD-FEC core</p>
<dl class="macro">
<dt id="c.XSDFEC_GET_STATUS">
<code class="descname">XSDFEC_GET_STATUS</code><a class="headerlink" href="#c.XSDFEC_GET_STATUS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><strong>Description</strong></p>
<p>ioctl that returns status of SD-FEC core</p>
<dl class="macro">
<dt id="c.XSDFEC_SET_IRQ">
<code class="descname">XSDFEC_SET_IRQ</code><a class="headerlink" href="#c.XSDFEC_SET_IRQ" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><strong>struct</strong> xsdfec_irq *</dt>
<dd>Pointer to the <a class="reference internal" href="#c.xsdfec_irq" title="xsdfec_irq"><code class="xref c c-type docutils literal"><span class="pre">struct</span> <span class="pre">xsdfec_irq</span></code></a> that contains the interrupt settings
for the SD-FEC core</dd>
</dl>
<p><strong>Description</strong></p>
<p>ioctl to enable or disable irq</p>
<dl class="macro">
<dt id="c.XSDFEC_SET_TURBO">
<code class="descname">XSDFEC_SET_TURBO</code><a class="headerlink" href="#c.XSDFEC_SET_TURBO" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><strong>struct</strong> xsdfec_turbo *</dt>
<dd>Pointer to the <a class="reference internal" href="#c.xsdfec_turbo" title="xsdfec_turbo"><code class="xref c c-type docutils literal"><span class="pre">struct</span> <span class="pre">xsdfec_turbo</span></code></a> that contains the Turbo decode
settings for the SD-FEC core</dd>
</dl>
<p><strong>Description</strong></p>
<p>ioctl that sets the SD-FEC Turbo parameter values</p>
<p>This can only be used when the driver is in the XSDFEC_STOPPED state</p>
<dl class="macro">
<dt id="c.XSDFEC_ADD_LDPC_CODE_PARAMS">
<code class="descname">XSDFEC_ADD_LDPC_CODE_PARAMS</code><a class="headerlink" href="#c.XSDFEC_ADD_LDPC_CODE_PARAMS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><strong>struct</strong> xsdfec_ldpc_params *</dt>
<dd>Pointer to the <a class="reference internal" href="#c.xsdfec_ldpc_params" title="xsdfec_ldpc_params"><code class="xref c c-type docutils literal"><span class="pre">struct</span> <span class="pre">xsdfec_ldpc_params</span></code></a> that contains the LDPC code
parameters to be added to the SD-FEC Block</dd>
</dl>
<p><strong>Description</strong>
ioctl to add an LDPC code to the SD-FEC LDPC codes</p>
<p>This can only be used when:</p>
<ul class="simple">
<li>Driver is in the XSDFEC_STOPPED state</li>
<li>SD-FEC core is configured as LPDC</li>
<li>SD-FEC Code Write Protection is disabled</li>
</ul>
<dl class="macro">
<dt id="c.XSDFEC_GET_CONFIG">
<code class="descname">XSDFEC_GET_CONFIG</code><a class="headerlink" href="#c.XSDFEC_GET_CONFIG" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><strong>struct</strong> xsdfec_config *</dt>
<dd>Pointer to the <a class="reference internal" href="#c.xsdfec_config" title="xsdfec_config"><code class="xref c c-type docutils literal"><span class="pre">struct</span> <span class="pre">xsdfec_config</span></code></a> that contains the current
configuration settings of the SD-FEC Block</dd>
</dl>
<p><strong>Description</strong></p>
<p>ioctl that returns SD-FEC core configuration</p>
<dl class="macro">
<dt id="c.XSDFEC_SET_ORDER">
<code class="descname">XSDFEC_SET_ORDER</code><a class="headerlink" href="#c.XSDFEC_SET_ORDER" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><strong>struct</strong> unsigned long *</dt>
<dd>Pointer to the unsigned long that contains a value from the
<strong>enum</strong> xsdfec_order</dd>
</dl>
<p><strong>Description</strong></p>
<p>ioctl that sets order, if order of blocks can change from input to output</p>
<p>This can only be used when the driver is in the XSDFEC_STOPPED state</p>
<dl class="macro">
<dt id="c.XSDFEC_SET_BYPASS">
<code class="descname">XSDFEC_SET_BYPASS</code><a class="headerlink" href="#c.XSDFEC_SET_BYPASS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><strong>struct</strong> bool *</dt>
<dd>Pointer to bool that sets the bypass value, where false results in
normal operation and false results in the SD-FEC performing the
configured operations (same number of cycles) but output data matches
the input data</dd>
</dl>
<p><strong>Description</strong></p>
<p>ioctl that sets bypass.</p>
<p>This can only be used when the driver is in the XSDFEC_STOPPED state</p>
<dl class="macro">
<dt id="c.XSDFEC_IS_ACTIVE">
<code class="descname">XSDFEC_IS_ACTIVE</code><a class="headerlink" href="#c.XSDFEC_IS_ACTIVE" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><strong>struct</strong> bool *</dt>
<dd>Pointer to bool that returns true if the SD-FEC is processing data</dd>
</dl>
<p><strong>Description</strong></p>
<p>ioctl that determines if SD-FEC is processing data</p>
<dl class="macro">
<dt id="c.XSDFEC_CLEAR_STATS">
<code class="descname">XSDFEC_CLEAR_STATS</code><a class="headerlink" href="#c.XSDFEC_CLEAR_STATS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><strong>Description</strong></p>
<p>ioctl that clears error stats collected during interrupts</p>
<dl class="macro">
<dt id="c.XSDFEC_GET_STATS">
<code class="descname">XSDFEC_GET_STATS</code><a class="headerlink" href="#c.XSDFEC_GET_STATS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><strong>struct</strong> xsdfec_stats *</dt>
<dd>Pointer to the <a class="reference internal" href="#c.xsdfec_stats" title="xsdfec_stats"><code class="xref c c-type docutils literal"><span class="pre">struct</span> <span class="pre">xsdfec_stats</span></code></a> that will contain the updated stats
values</dd>
</dl>
<p><strong>Description</strong></p>
<p>ioctl that returns SD-FEC core stats</p>
<p>This can only be used when the driver is in the XSDFEC_STOPPED state</p>
<dl class="macro">
<dt id="c.XSDFEC_SET_DEFAULT_CONFIG">
<code class="descname">XSDFEC_SET_DEFAULT_CONFIG</code><a class="headerlink" href="#c.XSDFEC_SET_DEFAULT_CONFIG" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p><strong>Description</strong></p>
<p>ioctl that returns SD-FEC core to default config, use after a reset</p>
<p>This can only be used when the driver is in the XSDFEC_STOPPED state</p>
</div>
<div class="section" id="driver-type-definitions">
<h2>Driver Type Definitions<a class="headerlink" href="#driver-type-definitions" title="Permalink to this headline">¶</a></h2>
<dl class="type">
<dt id="c.xsdfec_code">
enum <code class="descname">xsdfec_code</code><a class="headerlink" href="#c.xsdfec_code" title="Permalink to this definition">¶</a></dt>
<dd><p>Code Type.</p>
</dd></dl>

<p><strong>Constants</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">XSDFEC_CODE_INVALID</span></code></dt>
<dd>Driver is in a invalid mode.</dd>
<dt><code class="docutils literal"><span class="pre">XSDFEC_TURBO_CODE</span></code></dt>
<dd>Driver is configured for Turbo mode.</dd>
<dt><code class="docutils literal"><span class="pre">XSDFEC_LDPC_CODE</span></code></dt>
<dd>Driver is configured for LDPC mode.</dd>
</dl>
<p><strong>Description</strong></p>
<p>This enum is used to indicate the mode of the driver. The mode is determined
by checking which codes are set in the driver. Note that the mode cannot be
changed by the driver.</p>
<dl class="type">
<dt id="c.xsdfec_order">
enum <code class="descname">xsdfec_order</code><a class="headerlink" href="#c.xsdfec_order" title="Permalink to this definition">¶</a></dt>
<dd><p>Order</p>
</dd></dl>

<p><strong>Constants</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">XSDFEC_INVALID_ORDER</span></code></dt>
<dd>Invalid order value</dd>
<dt><code class="docutils literal"><span class="pre">XSDFEC_MAINTAIN_ORDER</span></code></dt>
<dd>Maintain order execution of blocks.</dd>
<dt><code class="docutils literal"><span class="pre">XSDFEC_OUT_OF_ORDER</span></code></dt>
<dd>Out-of-order execution of blocks.</dd>
<dt><code class="docutils literal"><span class="pre">XSDFEC_ORDER_MAX</span></code></dt>
<dd>Used to indicate out of bound order values.</dd>
</dl>
<p><strong>Description</strong></p>
<p>This enum is used to indicate whether the order of blocks can change from
input to output.</p>
<dl class="type">
<dt id="c.xsdfec_turbo_alg">
enum <code class="descname">xsdfec_turbo_alg</code><a class="headerlink" href="#c.xsdfec_turbo_alg" title="Permalink to this definition">¶</a></dt>
<dd><p>Turbo Algorithm Type.</p>
</dd></dl>

<p><strong>Constants</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">XSDFEC_MAX_SCALE</span></code></dt>
<dd>Max Log-Map algorithm with extrinsic scaling. When
scaling is set to this is equivalent to the Max Log-Map
algorithm.</dd>
<dt><code class="docutils literal"><span class="pre">XSDFEC_MAX_STAR</span></code></dt>
<dd>Log-Map algorithm.</dd>
<dt><code class="docutils literal"><span class="pre">XSDFEC_TURBO_ALG_MAX</span></code></dt>
<dd>Used to indicate out of bound Turbo algorithms.</dd>
</dl>
<p><strong>Description</strong></p>
<p>This enum specifies which Turbo Decode algorithm is in use.</p>
<dl class="type">
<dt id="c.xsdfec_state">
enum <code class="descname">xsdfec_state</code><a class="headerlink" href="#c.xsdfec_state" title="Permalink to this definition">¶</a></dt>
<dd><p>State.</p>
</dd></dl>

<p><strong>Constants</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">XSDFEC_INIT</span></code></dt>
<dd>Driver is initialized.</dd>
<dt><code class="docutils literal"><span class="pre">XSDFEC_STARTED</span></code></dt>
<dd>Driver is started.</dd>
<dt><code class="docutils literal"><span class="pre">XSDFEC_STOPPED</span></code></dt>
<dd>Driver is stopped.</dd>
<dt><code class="docutils literal"><span class="pre">XSDFEC_NEEDS_RESET</span></code></dt>
<dd>Driver needs to be reset.</dd>
<dt><code class="docutils literal"><span class="pre">XSDFEC_PL_RECONFIGURE</span></code></dt>
<dd>Programmable Logic needs to be recofigured.</dd>
</dl>
<p><strong>Description</strong></p>
<p>This enum is used to indicate the state of the driver.</p>
<dl class="type">
<dt id="c.xsdfec_axis_width">
enum <code class="descname">xsdfec_axis_width</code><a class="headerlink" href="#c.xsdfec_axis_width" title="Permalink to this definition">¶</a></dt>
<dd><p>AXIS_WIDTH.DIN Setting for 128-bit width.</p>
</dd></dl>

<p><strong>Constants</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">XSDFEC_1x128b</span></code></dt>
<dd>DIN data input stream consists of a 128-bit lane</dd>
<dt><code class="docutils literal"><span class="pre">XSDFEC_2x128b</span></code></dt>
<dd>DIN data input stream consists of two 128-bit lanes</dd>
<dt><code class="docutils literal"><span class="pre">XSDFEC_4x128b</span></code></dt>
<dd>DIN data input stream consists of four 128-bit lanes</dd>
</dl>
<p><strong>Description</strong></p>
<p>This enum is used to indicate the AXIS_WIDTH.DIN setting for 128-bit width.
The number of lanes of the DIN data input stream depends upon the
AXIS_WIDTH.DIN parameter.</p>
<dl class="type">
<dt id="c.xsdfec_axis_word_include">
enum <code class="descname">xsdfec_axis_word_include</code><a class="headerlink" href="#c.xsdfec_axis_word_include" title="Permalink to this definition">¶</a></dt>
<dd><p>Words Configuration.</p>
</dd></dl>

<p><strong>Constants</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">XSDFEC_FIXED_VALUE</span></code></dt>
<dd>Fixed, the DIN_WORDS AXI4-Stream interface is removed
from the IP instance and is driven with the specified
number of words.</dd>
<dt><code class="docutils literal"><span class="pre">XSDFEC_IN_BLOCK</span></code></dt>
<dd>In Block, configures the IP instance to expect a single
DIN_WORDS value per input code block. The DIN_WORDS
interface is present.</dd>
<dt><code class="docutils literal"><span class="pre">XSDFEC_PER_AXI_TRANSACTION</span></code></dt>
<dd>Per Transaction, configures the IP instance to
expect one DIN_WORDS value per input transaction on the DIN interface. The
DIN_WORDS interface is present.</dd>
<dt><code class="docutils literal"><span class="pre">XSDFEC_AXIS_WORDS_INCLUDE_MAX</span></code></dt>
<dd>Used to indicate out of bound Words
Configurations.</dd>
</dl>
<p><strong>Description</strong></p>
<p>This enum is used to specify the DIN_WORDS configuration.</p>
<dl class="type">
<dt id="c.xsdfec_turbo">
struct <code class="descname">xsdfec_turbo</code><a class="headerlink" href="#c.xsdfec_turbo" title="Permalink to this definition">¶</a></dt>
<dd><p>User data for Turbo codes.</p>
</dd></dl>

<p><strong>Definition</strong></p>
<div class="highlight-none"><div class="highlight"><pre><span></span>struct xsdfec_turbo {
  enum xsdfec_turbo_alg alg;
  u8 scale;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">alg</span></code></dt>
<dd>Specifies which Turbo decode algorithm to use</dd>
<dt><code class="docutils literal"><span class="pre">scale</span></code></dt>
<dd>Specifies the extrinsic scaling to apply when the Max Scale algorithm
has been selected</dd>
</dl>
<p><strong>Description</strong></p>
<p>Turbo code structure to communicate parameters to XSDFEC driver.</p>
<dl class="type">
<dt id="c.xsdfec_ldpc_params">
struct <code class="descname">xsdfec_ldpc_params</code><a class="headerlink" href="#c.xsdfec_ldpc_params" title="Permalink to this definition">¶</a></dt>
<dd><p>User data for LDPC codes.</p>
</dd></dl>

<p><strong>Definition</strong></p>
<div class="highlight-none"><div class="highlight"><pre><span></span>struct xsdfec_ldpc_params {
  u32 n;
  u32 k;
  u32 psize;
  u32 nlayers;
  u32 nqc;
  u32 nmqc;
  u32 nm;
  u32 norm_type;
  u32 no_packing;
  u32 special_qc;
  u32 no_final_parity;
  u32 max_schedule;
  u32 sc_off;
  u32 la_off;
  u32 qc_off;
  u32 sc_table;
  u32 la_table;
  u32 qc_table;
  u16 code_id;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">n</span></code></dt>
<dd>Number of code word bits</dd>
<dt><code class="docutils literal"><span class="pre">k</span></code></dt>
<dd>Number of information bits</dd>
<dt><code class="docutils literal"><span class="pre">psize</span></code></dt>
<dd>Size of sub-matrix</dd>
<dt><code class="docutils literal"><span class="pre">nlayers</span></code></dt>
<dd>Number of layers in code</dd>
<dt><code class="docutils literal"><span class="pre">nqc</span></code></dt>
<dd>Quasi Cyclic Number</dd>
<dt><code class="docutils literal"><span class="pre">nmqc</span></code></dt>
<dd>Number of M-sized QC operations in parity check matrix</dd>
<dt><code class="docutils literal"><span class="pre">nm</span></code></dt>
<dd>Number of M-size vectors in N</dd>
<dt><code class="docutils literal"><span class="pre">norm_type</span></code></dt>
<dd>Normalization required or not</dd>
<dt><code class="docutils literal"><span class="pre">no_packing</span></code></dt>
<dd>Determines if multiple QC ops should be performed</dd>
<dt><code class="docutils literal"><span class="pre">special_qc</span></code></dt>
<dd>Sub-Matrix property for Circulant weight &gt; 0</dd>
<dt><code class="docutils literal"><span class="pre">no_final_parity</span></code></dt>
<dd>Decide if final parity check needs to be performed</dd>
<dt><code class="docutils literal"><span class="pre">max_schedule</span></code></dt>
<dd>Experimental code word scheduling limit</dd>
<dt><code class="docutils literal"><span class="pre">sc_off</span></code></dt>
<dd>SC offset</dd>
<dt><code class="docutils literal"><span class="pre">la_off</span></code></dt>
<dd>LA offset</dd>
<dt><code class="docutils literal"><span class="pre">qc_off</span></code></dt>
<dd>QC offset</dd>
<dt><code class="docutils literal"><span class="pre">sc_table</span></code></dt>
<dd>SC Table</dd>
<dt><code class="docutils literal"><span class="pre">la_table</span></code></dt>
<dd>LA Table</dd>
<dt><code class="docutils literal"><span class="pre">qc_table</span></code></dt>
<dd>QC Table</dd>
<dt><code class="docutils literal"><span class="pre">code_id</span></code></dt>
<dd>LDPC Code</dd>
</dl>
<p><strong>Description</strong></p>
<p>This structure describes the LDPC code that is passed to the driver by the
application.</p>
<dl class="type">
<dt id="c.xsdfec_status">
struct <code class="descname">xsdfec_status</code><a class="headerlink" href="#c.xsdfec_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Status of SD-FEC core.</p>
</dd></dl>

<p><strong>Definition</strong></p>
<div class="highlight-none"><div class="highlight"><pre><span></span>struct xsdfec_status {
  s32 fec_id;
  enum xsdfec_state state;
  bool activity;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">fec_id</span></code></dt>
<dd>ID of SD-FEC instance</dd>
<dt><code class="docutils literal"><span class="pre">state</span></code></dt>
<dd>State of the SD-FEC core</dd>
<dt><code class="docutils literal"><span class="pre">activity</span></code></dt>
<dd>Describes if the SD-FEC instance is Active</dd>
</dl>
<dl class="type">
<dt id="c.xsdfec_irq">
struct <code class="descname">xsdfec_irq</code><a class="headerlink" href="#c.xsdfec_irq" title="Permalink to this definition">¶</a></dt>
<dd><p>Enabling or Disabling Interrupts.</p>
</dd></dl>

<p><strong>Definition</strong></p>
<div class="highlight-none"><div class="highlight"><pre><span></span>struct xsdfec_irq {
  bool enable_isr;
  bool enable_ecc_isr;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">enable_isr</span></code></dt>
<dd>If true enables the ISR</dd>
<dt><code class="docutils literal"><span class="pre">enable_ecc_isr</span></code></dt>
<dd>If true enables the ECC ISR</dd>
</dl>
<dl class="type">
<dt id="c.xsdfec_config">
struct <code class="descname">xsdfec_config</code><a class="headerlink" href="#c.xsdfec_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Configuration of SD-FEC core.</p>
</dd></dl>

<p><strong>Definition</strong></p>
<div class="highlight-none"><div class="highlight"><pre><span></span>struct xsdfec_config {
  s32 fec_id;
  enum xsdfec_code code;
  enum xsdfec_order order;
  bool bypass;
  bool code_wr_protect;
  enum xsdfec_axis_width din_width;
  enum xsdfec_axis_word_include din_word_include;
  enum xsdfec_axis_width dout_width;
  enum xsdfec_axis_word_include dout_word_include;
  struct xsdfec_irq irq;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">fec_id</span></code></dt>
<dd>ID of SD-FEC instance</dd>
<dt><code class="docutils literal"><span class="pre">code</span></code></dt>
<dd>The codes being used by the SD-FEC instance</dd>
<dt><code class="docutils literal"><span class="pre">order</span></code></dt>
<dd>Order of Operation</dd>
<dt><code class="docutils literal"><span class="pre">bypass</span></code></dt>
<dd>Is the core being bypassed</dd>
<dt><code class="docutils literal"><span class="pre">code_wr_protect</span></code></dt>
<dd>Is write protection of LDPC codes enabled</dd>
<dt><code class="docutils literal"><span class="pre">din_width</span></code></dt>
<dd>Width of the DIN AXI4-Stream</dd>
<dt><code class="docutils literal"><span class="pre">din_word_include</span></code></dt>
<dd>How DIN_WORDS are inputted</dd>
<dt><code class="docutils literal"><span class="pre">dout_width</span></code></dt>
<dd>Width of the DOUT AXI4-Stream</dd>
<dt><code class="docutils literal"><span class="pre">dout_word_include</span></code></dt>
<dd>HOW DOUT_WORDS are outputted</dd>
<dt><code class="docutils literal"><span class="pre">irq</span></code></dt>
<dd>Enabling or disabling interrupts</dd>
</dl>
<dl class="type">
<dt id="c.xsdfec_stats">
struct <code class="descname">xsdfec_stats</code><a class="headerlink" href="#c.xsdfec_stats" title="Permalink to this definition">¶</a></dt>
<dd><p>Stats retrived by ioctl XSDFEC_GET_STATS. Used to buffer atomic_t variables from struct xsdfec_dev.</p>
</dd></dl>

<p><strong>Definition</strong></p>
<div class="highlight-none"><div class="highlight"><pre><span></span>struct xsdfec_stats {
  u32 isr_err_count;
  u32 cecc_count;
  u32 uecc_count;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">isr_err_count</span></code></dt>
<dd>Count of ISR errors</dd>
<dt><code class="docutils literal"><span class="pre">cecc_count</span></code></dt>
<dd>Count of Correctable ECC errors (SBE)</dd>
<dt><code class="docutils literal"><span class="pre">uecc_count</span></code></dt>
<dd>Count of Uncorrectable ECC errors (MBE)</dd>
</dl>
<dl class="type">
<dt id="c.xsdfec_ldpc_param_table_sizes">
struct <code class="descname">xsdfec_ldpc_param_table_sizes</code><a class="headerlink" href="#c.xsdfec_ldpc_param_table_sizes" title="Permalink to this definition">¶</a></dt>
<dd><p>Used to store sizes of SD-FEC table entries for an individual LPDC code parameter.</p>
</dd></dl>

<p><strong>Definition</strong></p>
<div class="highlight-none"><div class="highlight"><pre><span></span>struct xsdfec_ldpc_param_table_sizes {
  u32 sc_size;
  u32 la_size;
  u32 qc_size;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">sc_size</span></code></dt>
<dd>Size of SC table used</dd>
<dt><code class="docutils literal"><span class="pre">la_size</span></code></dt>
<dd>Size of LA table used</dd>
<dt><code class="docutils literal"><span class="pre">qc_size</span></code></dt>
<dd>Size of QC table used</dd>
</dl>
<dl class="function">
<dt id="c.xsdfec_calculate_shared_ldpc_table_entry_size">
void <code class="descname">xsdfec_calculate_shared_ldpc_table_entry_size</code><span class="sig-paren">(</span>struct <a class="reference internal" href="#c.xsdfec_ldpc_params" title="xsdfec_ldpc_params">xsdfec_ldpc_params</a> *<em>&nbsp;ldpc</em>, struct <a class="reference internal" href="#c.xsdfec_ldpc_param_table_sizes" title="xsdfec_ldpc_param_table_sizes">xsdfec_ldpc_param_table_sizes</a> *<em>&nbsp;table_sizes</em><span class="sig-paren">)</span><a class="headerlink" href="#c.xsdfec_calculate_shared_ldpc_table_entry_size" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates shared code table sizes.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">xsdfec_ldpc_params</span> <span class="pre">*</span> <span class="pre">ldpc</span></code></dt>
<dd>Pointer to the LPDC Code Parameters</dd>
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">xsdfec_ldpc_param_table_sizes</span> <span class="pre">*</span> <span class="pre">table_sizes</span></code></dt>
<dd>Pointer to structure containing the calculated table sizes</dd>
</dl>
<p><strong>Description</strong></p>
<p>Calculates the size of shared LDPC code tables used for a specified LPDC code
parameters.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>