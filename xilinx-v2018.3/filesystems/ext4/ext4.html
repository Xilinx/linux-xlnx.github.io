

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>1. General Information &mdash; The Linux Kernel  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="2. Data Structures and Algorithms" href="ondisk/index.html" />
    <link rel="prev" title="ext4 Filesystem" href="index.html" /> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                4.19.0-xilinx-v2018.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../process/license-rules.html">Linux kernel licensing rules</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../admin-guide/index.html">The Linux kernel user’s and administrator’s guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../userspace-api/index.html">The Linux kernel user-space API guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../process/index.html">Working with the kernel development community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../trace/index.html">Linux Tracing Technologies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../maintainer/index.html">Kernel Maintainer Handbook</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../driver-api/index.html">The Linux driver implementer’s API guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../media/index.html">Linux Media Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../networking/index.html">Linux Networking Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../input/index.html">The Linux Input Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../gpu/index.html">Linux GPU Driver Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../security/index.html">Security Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../sound/index.html">Linux Sound Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../crypto/index.html">Linux Kernel Crypto API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Linux Filesystems API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../vm/index.html">Linux Memory Management Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../bpf/index.html">BPF Documentation</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../sh/index.html">SuperH Interfaces Guide</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">ext4 Filesystem</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">1. General Information</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#quick-usage-instructions">1.1. Quick usage instructions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#features">1.2. Features</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#currently-available">1.2.1. Currently Available</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#options">1.3. Options</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data-mode">1.4. Data Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#proc-entries">1.5. /proc entries</a></li>
<li class="toctree-l3"><a class="reference internal" href="#sys-entries">1.6. /sys entries</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ioctls">1.7. Ioctls</a></li>
<li class="toctree-l3"><a class="reference internal" href="#references">1.8. References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="ondisk/index.html">2. Data Structures and Algorithms</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../translations/index.html">Translations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">ext4 Filesystem</a> &raquo;</li>
        
      <li>1. General Information</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/filesystems/ext4/ext4.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="general-information">
<h1>1. General Information<a class="headerlink" href="#general-information" title="Permalink to this headline">¶</a></h1>
<p>Ext4 is an advanced level of the ext3 filesystem which incorporates
scalability and reliability enhancements for supporting large filesystems
(64 bit) in keeping with increasing disk capacities and state-of-the-art
feature requirements.</p>
<p>Mailing list:   <a class="reference external" href="mailto:linux-ext4&#37;&#52;&#48;vger&#46;kernel&#46;org">linux-ext4<span>&#64;</span>vger<span>&#46;</span>kernel<span>&#46;</span>org</a>
Web site:       <a class="reference external" href="http://ext4.wiki.kernel.org">http://ext4.wiki.kernel.org</a></p>
<div class="section" id="quick-usage-instructions">
<h2>1.1. Quick usage instructions<a class="headerlink" href="#quick-usage-instructions" title="Permalink to this headline">¶</a></h2>
<p>Note: More extensive information for getting started with ext4 can be
found at the ext4 wiki site at the URL:
<a class="reference external" href="http://ext4.wiki.kernel.org/index.php/Ext4_Howto">http://ext4.wiki.kernel.org/index.php/Ext4_Howto</a></p>
<blockquote>
<div><ul>
<li><p class="first">The latest version of e2fsprogs can be found at:</p>
<p><a class="reference external" href="https://www.kernel.org/pub/linux/kernel/people/tytso/e2fsprogs/">https://www.kernel.org/pub/linux/kernel/people/tytso/e2fsprogs/</a></p>
<blockquote>
<div><p>or</p>
</div></blockquote>
<p><a class="reference external" href="http://sourceforge.net/project/showfiles.php?group_id=2406">http://sourceforge.net/project/showfiles.php?group_id=2406</a></p>
<blockquote>
<div><p>or grab the latest git repository from:</p>
</div></blockquote>
</li>
</ul>
<blockquote>
<div><a class="reference external" href="https://git.kernel.org/pub/scm/fs/ext2/e2fsprogs.git">https://git.kernel.org/pub/scm/fs/ext2/e2fsprogs.git</a></div></blockquote>
<ul>
<li><p class="first">Create a new filesystem using the ext4 filesystem type:</p>
<blockquote>
<div><p># mke2fs -t ext4 /dev/hda1</p>
</div></blockquote>
<p>Or to configure an existing ext3 filesystem to support extents:</p>
<blockquote>
<div><p># tune2fs -O extents /dev/hda1</p>
</div></blockquote>
<p>If the filesystem was created with 128 byte inodes, it can be
converted to use 256 byte for greater efficiency via:</p>
<blockquote>
<div><p># tune2fs -I 256 /dev/hda1</p>
</div></blockquote>
</li>
<li><p class="first">Mounting:</p>
<blockquote>
<div><p># mount -t ext4 /dev/hda1 /wherever</p>
</div></blockquote>
</li>
<li><p class="first">When comparing performance with other filesystems, it’s always
important to try multiple workloads; very often a subtle change in a
workload parameter can completely change the ranking of which
filesystems do well compared to others.  When comparing versus ext3,
note that ext4 enables write barriers by default, while ext3 does
not enable write barriers by default.  So it is useful to use
explicitly specify whether barriers are enabled or not when via the
‘-o barriers=[0|1]’ mount option for both ext3 and ext4 filesystems
for a fair comparison.  When tuning ext3 for best benchmark numbers,
it is often worthwhile to try changing the data journaling mode; ‘-o
data=writeback’ can be faster for some workloads.  (Note however that
running mounted with data=writeback can potentially leave stale data
exposed in recently written files in case of an unclean shutdown,
which could be a security exposure in some situations.)  Configuring
the filesystem with a large journal can also be helpful for
metadata-intensive workloads.</p>
</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="features">
<h2>1.2. Features<a class="headerlink" href="#features" title="Permalink to this headline">¶</a></h2>
<div class="section" id="currently-available">
<h3>1.2.1. Currently Available<a class="headerlink" href="#currently-available" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li>ability to use filesystems &gt; 16TB (e2fsprogs support not available yet)</li>
<li>extent format reduces metadata overhead (RAM, IO for access, transactions)</li>
<li>extent format more robust in face of on-disk corruption due to magics,</li>
<li>internal redundancy in tree</li>
<li>improved file allocation (multi-block alloc)</li>
<li>lift 32000 subdirectory limit imposed by i_links_count[1]</li>
<li>nsec timestamps for mtime, atime, ctime, create time</li>
<li>inode version field on disk (NFSv4, Lustre)</li>
<li>reduced e2fsck time via uninit_bg feature</li>
<li>journal checksumming for robustness, performance</li>
<li>persistent file preallocation (e.g for streaming media, databases)</li>
<li>ability to pack bitmaps and inode tables into larger virtual groups via the
flex_bg feature</li>
<li>large file support</li>
<li>inode allocation using large virtual block groups via flex_bg</li>
<li>delayed allocation</li>
<li>large block (up to pagesize) support</li>
<li>efficient new ordered mode in JBD2 and ext4 (avoid using buffer head to force
the ordering)</li>
</ul>
<p>[1] Filesystems with a block size of 1k may see a limit imposed by the
directory hash tree having a maximum depth of two.</p>
</div>
</div>
<div class="section" id="options">
<h2>1.3. Options<a class="headerlink" href="#options" title="Permalink to this headline">¶</a></h2>
<p>When mounting an ext4 filesystem, the following option are accepted:
(*) == default</p>
<table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="71%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Mount Option</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>ro</td>
<td>Mount filesystem read only. Note that ext4 will
replay the journal (and thus write to the
partition) even when mounted “read only”. The
mount options “ro,noload” can be used to prevent
writes to the filesystem.</td>
</tr>
<tr class="row-odd"><td>journal_checksum</td>
<td>Enable checksumming of the journal transactions.
This will allow the recovery code in e2fsck and the
kernel to detect corruption in the kernel.  It is a
compatible change and will be ignored by older kernels.</td>
</tr>
<tr class="row-even"><td>journal_async_commit</td>
<td>Commit block can be written to disk without waiting
for descriptor blocks. If enabled older kernels cannot
mount the device. This will enable ‘journal_checksum’
internally.</td>
</tr>
<tr class="row-odd"><td>journal_path=path</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>journal_dev=devnum</td>
<td>When the external journal device’s major/minor numbers
have changed, these options allow the user to specify
the new journal location.  The journal device is
identified through either its new major/minor numbers
encoded in devnum, or via a path to the device.</td>
</tr>
<tr class="row-odd"><td>norecovery</td>
<td>Don’t load the journal on mounting.  Note that</td>
</tr>
<tr class="row-even"><td>noload</td>
<td>if the filesystem was not unmounted cleanly,
skipping the journal replay will lead to the
filesystem containing inconsistencies that can
lead to any number of problems.</td>
</tr>
<tr class="row-odd"><td>data=journal</td>
<td>All data are committed into the journal prior to being
written into the main file system.  Enabling
this mode will disable delayed allocation and
O_DIRECT support.</td>
</tr>
<tr class="row-even"><td>data=ordered    (*)</td>
<td>All data are forced directly out to the main file
system prior to its metadata being committed to the
journal.</td>
</tr>
<tr class="row-odd"><td>data=writeback</td>
<td>Data ordering is not preserved, data may be written
into the main file system after its metadata has been
committed to the journal.</td>
</tr>
<tr class="row-even"><td>commit=nrsec    (*)</td>
<td>Ext4 can be told to sync all its data and metadata
every ‘nrsec’ seconds. The default value is 5 seconds.
This means that if you lose your power, you will lose
as much as the latest 5 seconds of work (your
filesystem will not be damaged though, thanks to the
journaling).  This default value (or any low value)
will hurt performance, but it’s good for data-safety.
Setting it to 0 will have the same effect as leaving
it at the default (5 seconds).
Setting it to very large values will improve
performance.</td>
</tr>
<tr class="row-odd"><td>barrier=&lt;0|1(*)&gt;</td>
<td>This enables/disables the use of write barriers in</td>
</tr>
<tr class="row-even"><td>barrier(*)</td>
<td>the jbd code.  barrier=0 disables, barrier=1 enables.</td>
</tr>
<tr class="row-odd"><td>nobarrier</td>
<td>This also requires an IO stack which can support
barriers, and if jbd gets an error on a barrier
write, it will disable again with a warning.
Write barriers enforce proper on-disk ordering
of journal commits, making volatile disk write caches
safe to use, at some performance penalty.  If
your disks are battery-backed in one way or another,
disabling barriers may safely improve performance.
The mount options “barrier” and “nobarrier” can
also be used to enable or disable barriers, for
consistency with other ext4 mount options.</td>
</tr>
<tr class="row-even"><td>inode_readahead_blks=n</td>
<td>This tuning parameter controls the maximum
number of inode table blocks that ext4’s inode
table readahead algorithm will pre-read into
the buffer cache.  The default value is 32 blocks.</td>
</tr>
<tr class="row-odd"><td>nouser_xattr</td>
<td>Disables Extended User Attributes.  See the
attr(5) manual page for more information about
extended attributes.</td>
</tr>
<tr class="row-even"><td>noacl</td>
<td>This option disables POSIX Access Control List
support. If ACL support is enabled in the kernel
configuration (CONFIG_EXT4_FS_POSIX_ACL), ACL is
enabled by default on mount. See the acl(5) manual
page for more information about acl.</td>
</tr>
<tr class="row-odd"><td>bsddf           (*)</td>
<td>Make ‘df’ act like BSD.</td>
</tr>
<tr class="row-even"><td>minixdf</td>
<td>Make ‘df’ act like Minix.</td>
</tr>
<tr class="row-odd"><td>debug</td>
<td>Extra debugging information is sent to syslog.</td>
</tr>
<tr class="row-even"><td>abort</td>
<td>Simulate the effects of calling ext4_abort() for
debugging purposes.  This is normally used while
remounting a filesystem which is already mounted.</td>
</tr>
<tr class="row-odd"><td>errors=remount-ro</td>
<td>Remount the filesystem read-only on an error.</td>
</tr>
<tr class="row-even"><td>errors=continue</td>
<td>Keep going on a filesystem error.</td>
</tr>
<tr class="row-odd"><td>errors=panic</td>
<td>Panic and halt the machine if an error occurs.
(These mount options override the errors behavior
specified in the superblock, which can be configured
using tune2fs)</td>
</tr>
<tr class="row-even"><td>data_err=ignore(*)</td>
<td>Just print an error message if an error occurs
in a file data buffer in ordered mode.</td>
</tr>
<tr class="row-odd"><td>data_err=abort</td>
<td>Abort the journal if an error occurs in a file
data buffer in ordered mode.</td>
</tr>
<tr class="row-even"><td>grpid</td>
<td>New objects have the group ID of their parent.</td>
</tr>
<tr class="row-odd"><td>bsdgroups</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>nogrpid         (*)</td>
<td>New objects have the group ID of their creator.</td>
</tr>
<tr class="row-odd"><td>sysvgroups</td>
<td>&#160;</td>
</tr>
<tr class="row-even"><td>resgid=n</td>
<td>The group ID which may use the reserved blocks.</td>
</tr>
<tr class="row-odd"><td>resuid=n</td>
<td>The user ID which may use the reserved blocks.</td>
</tr>
<tr class="row-even"><td>sb=n</td>
<td>Use alternate superblock at this location.</td>
</tr>
<tr class="row-odd"><td>quota</td>
<td>These options are ignored by the filesystem. They</td>
</tr>
<tr class="row-even"><td>noquota</td>
<td>are used only by quota tools to recognize volumes</td>
</tr>
<tr class="row-odd"><td>grpquota</td>
<td>where quota should be turned on. See documentation</td>
</tr>
<tr class="row-even"><td>usrquota</td>
<td>in the quota-tools package for more details
(<a class="reference external" href="http://sourceforge.net/projects/linuxquota">http://sourceforge.net/projects/linuxquota</a>).</td>
</tr>
<tr class="row-odd"><td>jqfmt=&lt;quota type&gt;</td>
<td>These options tell filesystem details about quota</td>
</tr>
<tr class="row-even"><td>usrjquota=&lt;file&gt;</td>
<td>so that quota information can be properly updated</td>
</tr>
<tr class="row-odd"><td>grpjquota=&lt;file&gt;</td>
<td>during journal replay. They replace the above
quota options. See documentation in the quota-tools
package for more details
(<a class="reference external" href="http://sourceforge.net/projects/linuxquota">http://sourceforge.net/projects/linuxquota</a>).</td>
</tr>
<tr class="row-even"><td>stripe=n</td>
<td>Number of filesystem blocks that mballoc will try
to use for allocation size and alignment. For RAID5/6
systems this should be the number of data
disks *  RAID chunk size in file system blocks.</td>
</tr>
<tr class="row-odd"><td>delalloc        (*)</td>
<td>Defer block allocation until just before ext4
writes out the block(s) in question.  This
allows ext4 to better allocation decisions
more efficiently.</td>
</tr>
<tr class="row-even"><td>nodelalloc</td>
<td>Disable delayed allocation.  Blocks are allocated
when the data is copied from userspace to the
page cache, either via the write(2) system call
or when an mmap’ed page which was previously
unallocated is written for the first time.</td>
</tr>
<tr class="row-odd"><td>max_batch_time=usec</td>
<td>Maximum amount of time ext4 should wait for
additional filesystem operations to be batch
together with a synchronous write operation.
Since a synchronous write operation is going to
force a commit and then a wait for the I/O
complete, it doesn’t cost much, and can be a
huge throughput win, we wait for a small amount
of time to see if any other transactions can
piggyback on the synchronous write.   The
algorithm used is designed to automatically tune
for the speed of the disk, by measuring the
amount of time (on average) that it takes to
finish committing a transaction.  Call this time
the “commit time”.  If the time that the
transaction has been running is less than the
commit time, ext4 will try sleeping for the
commit time to see if other operations will join
the transaction.   The commit time is capped by
the max_batch_time, which defaults to 15000us
(15ms).   This optimization can be turned off
entirely by setting max_batch_time to 0.</td>
</tr>
<tr class="row-even"><td>min_batch_time=usec</td>
<td>This parameter sets the commit time (as
described above) to be at least min_batch_time.
It defaults to zero microseconds.  Increasing
this parameter may improve the throughput of
multi-threaded, synchronous workloads on very
fast disks, at the cost of increasing latency.</td>
</tr>
<tr class="row-odd"><td>journal_ioprio=prio</td>
<td>The I/O priority (from 0 to 7, where 0 is the
highest priority) which should be used for I/O
operations submitted by kjournald2 during a
commit operation.  This defaults to 3, which is
a slightly higher priority than the default I/O
priority.</td>
</tr>
<tr class="row-even"><td>auto_da_alloc(*)</td>
<td>Many broken applications don’t use fsync() when</td>
</tr>
<tr class="row-odd"><td>noauto_da_alloc</td>
<td>replacing existing files via patterns such as
fd = open(“foo.new”)/write(fd,..)/close(fd)/
rename(“foo.new”, “foo”), or worse yet,
fd = open(“foo”, O_TRUNC)/write(fd,..)/close(fd).
If auto_da_alloc is enabled, ext4 will detect
the replace-via-rename and replace-via-truncate
patterns and force that any delayed allocation
blocks are allocated such that at the next
journal commit, in the default data=ordered
mode, the data blocks of the new file are forced
to disk before the rename() operation is
committed.  This provides roughly the same level
of guarantees as ext3, and avoids the
“zero-length” problem that can happen when a
system crashes before the delayed allocation
blocks are forced to disk.</td>
</tr>
<tr class="row-even"><td>noinit_itable</td>
<td>Do not initialize any uninitialized inode table
blocks in the background.  This feature may be
used by installation CD’s so that the install
process can complete as quickly as possible; the
inode table initialization process would then be
deferred until the next time the  file system
is unmounted.</td>
</tr>
<tr class="row-odd"><td>init_itable=n</td>
<td>The lazy itable init code will wait n times the
number of milliseconds it took to zero out the
previous block group’s inode table.  This
minimizes the impact on the system performance
while file system’s inode table is being initialized.</td>
</tr>
<tr class="row-even"><td>discard</td>
<td>Controls whether ext4 should issue discard/TRIM</td>
</tr>
<tr class="row-odd"><td>nodiscard(*)</td>
<td>commands to the underlying block device when
blocks are freed.  This is useful for SSD devices
and sparse/thinly-provisioned LUNs, but it is off
by default until sufficient testing has been done.</td>
</tr>
<tr class="row-even"><td>nouid32</td>
<td>Disables 32-bit UIDs and GIDs.  This is for
interoperability  with  older kernels which only
store and expect 16-bit values.</td>
</tr>
<tr class="row-odd"><td>block_validity(*)</td>
<td>These options enable or disable the in-kernel</td>
</tr>
<tr class="row-even"><td>noblock_validity</td>
<td>facility for tracking filesystem metadata blocks
within internal data structures.  This allows multi-
block allocator and other routines to notice
bugs or corrupted allocation bitmaps which cause
blocks to be allocated which overlap with
filesystem metadata blocks.</td>
</tr>
<tr class="row-odd"><td>dioread_lock</td>
<td>Controls whether or not ext4 should use the DIO read</td>
</tr>
<tr class="row-even"><td>dioread_nolock</td>
<td>locking. If the dioread_nolock option is specified
ext4 will allocate uninitialized extent before buffer
write and convert the extent to initialized after IO
completes. This approach allows ext4 code to avoid
using inode mutex, which improves scalability on high
speed storages. However this does not work with
data journaling and dioread_nolock option will be
ignored with kernel warning. Note that dioread_nolock
code path is only used for extent-based files.
Because of the restrictions this options comprises
it is off by default (e.g. dioread_lock).</td>
</tr>
<tr class="row-odd"><td>max_dir_size_kb=n</td>
<td>This limits the size of directories so that any
attempt to expand them beyond the specified
limit in kilobytes will cause an ENOSPC error.
This is useful in memory constrained
environments, where a very large directory can
cause severe performance problems or even
provoke the Out Of Memory killer.  (For example,
if there is only 512mb memory available, a 176mb
directory may seriously cramp the system’s style.)</td>
</tr>
<tr class="row-even"><td>i_version</td>
<td>Enable 64-bit inode version support. This option is
off by default.</td>
</tr>
<tr class="row-odd"><td>dax</td>
<td>Use direct access (no page cache).  See
Documentation/filesystems/dax.txt.  Note that
this option is incompatible with data=journal.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="data-mode">
<h2>1.4. Data Mode<a class="headerlink" href="#data-mode" title="Permalink to this headline">¶</a></h2>
<p>There are 3 different data modes:</p>
<ul>
<li><p class="first">writeback mode</p>
<p>In data=writeback mode, ext4 does not journal data at all.  This mode provides
a similar level of journaling as that of XFS, JFS, and ReiserFS in its default
mode - metadata journaling.  A crash+recovery can cause incorrect data to
appear in files which were written shortly before the crash.  This mode will
typically provide the best ext4 performance.</p>
</li>
<li><p class="first">ordered mode</p>
<p>In data=ordered mode, ext4 only officially journals metadata, but it logically
groups metadata information related to data changes with the data blocks into
a single unit called a transaction.  When it’s time to write the new metadata
out to disk, the associated data blocks are written first.  In general, this
mode performs slightly slower than writeback but significantly faster than
journal mode.</p>
</li>
<li><p class="first">journal mode</p>
<p>data=journal mode provides full data and metadata journaling.  All new data is
written to the journal first, and then to its final location.  In the event of
a crash, the journal can be replayed, bringing both data and metadata into a
consistent state.  This mode is the slowest except when data needs to be read
from and written to disk at the same time where it outperforms all others
modes.  Enabling this mode will disable delayed allocation and O_DIRECT
support.</p>
</li>
</ul>
</div>
<div class="section" id="proc-entries">
<h2>1.5. /proc entries<a class="headerlink" href="#proc-entries" title="Permalink to this headline">¶</a></h2>
<p>Information about mounted ext4 file systems can be found in
/proc/fs/ext4.  Each mounted filesystem will have a directory in
/proc/fs/ext4 based on its device name (i.e., /proc/fs/ext4/hdc or
/proc/fs/ext4/dm-0).   The files in each per-device directory are shown
in table below.</p>
<p>Files in /proc/fs/ext4/&lt;devname&gt;</p>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">File</th>
<th class="head">Content</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>mb_groups</td>
<td>details of multiblock allocator buddy cache of free blocks</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="sys-entries">
<h2>1.6. /sys entries<a class="headerlink" href="#sys-entries" title="Permalink to this headline">¶</a></h2>
<p>Information about mounted ext4 file systems can be found in
/sys/fs/ext4.  Each mounted filesystem will have a directory in
/sys/fs/ext4 based on its device name (i.e., /sys/fs/ext4/hdc or
/sys/fs/ext4/dm-0).   The files in each per-device directory are shown
in table below.</p>
<p>Files in /sys/fs/ext4/&lt;devname&gt;:</p>
<p>(see also Documentation/ABI/testing/sysfs-fs-ext4)</p>
<table border="1" class="docutils">
<colgroup>
<col width="37%" />
<col width="63%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">File</th>
<th class="head">Content</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>delayed_allocation_blocks</td>
<td>This file is read-only and shows the number of
blocks that are dirty in the page cache, but
which do not have their location in the
filesystem allocated yet.</td>
</tr>
<tr class="row-odd"><td>inode_goal</td>
<td>Tuning parameter which (if non-zero) controls
the goal inode used by the inode allocator in
preference to all other allocation heuristics.
This is intended for debugging use only, and
should be 0 on production systems.</td>
</tr>
<tr class="row-even"><td>inode_readahead_blks</td>
<td>Tuning parameter which controls the maximum
number of inode table blocks that ext4’s inode
table readahead algorithm will pre-read into
the buffer cache</td>
</tr>
<tr class="row-odd"><td>lifetime_write_kbytes</td>
<td>This file is read-only and shows the number of
kilobytes of data that have been written to this
filesystem since it was created.</td>
</tr>
<tr class="row-even"><td>max_writeback_mb_bump</td>
<td>The maximum number of megabytes the writeback
code will try to write out before move on to
another inode.</td>
</tr>
<tr class="row-odd"><td>mb_group_prealloc</td>
<td>The multiblock allocator will round up allocation
requests to a multiple of this tuning parameter if
the stripe size is not set in the ext4 superblock</td>
</tr>
<tr class="row-even"><td>mb_max_to_scan</td>
<td>The maximum number of extents the multiblock
allocator will search to find the best extent</td>
</tr>
<tr class="row-odd"><td>mb_min_to_scan</td>
<td>The minimum number of extents the multiblock
allocator will search to find the best extent</td>
</tr>
<tr class="row-even"><td>mb_order2_req</td>
<td>Tuning parameter which controls the minimum size
for requests (as a power of 2) where the buddy
cache is used</td>
</tr>
<tr class="row-odd"><td>mb_stats</td>
<td>Controls whether the multiblock allocator should
collect statistics, which are shown during the
unmount. 1 means to collect statistics, 0 means
not to collect statistics</td>
</tr>
<tr class="row-even"><td>mb_stream_req</td>
<td>Files which have fewer blocks than this tunable
parameter will have their blocks allocated out
of a block group specific preallocation pool, so
that small files are packed closely together.
Each large file will have its blocks allocated
out of its own unique preallocation pool.</td>
</tr>
<tr class="row-odd"><td>session_write_kbytes</td>
<td>This file is read-only and shows the number of
kilobytes of data that have been written to this
filesystem since it was mounted.</td>
</tr>
<tr class="row-even"><td>reserved_clusters</td>
<td>This is RW file and contains number of reserved
clusters in the file system which will be used
in the specific situations to avoid costly
zeroout, unexpected ENOSPC, or possible data
loss. The default is 2% or 4096 clusters,
whichever is smaller and this can be changed
however it can never exceed number of clusters
in the file system. If there is not enough space
for the reserved space when mounting the file
mount will _not_ fail.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="ioctls">
<h2>1.7. Ioctls<a class="headerlink" href="#ioctls" title="Permalink to this headline">¶</a></h2>
<p>There is some Ext4 specific functionality which can be accessed by applications
through the system call interfaces. The list of all Ext4 specific ioctls are
shown in the table below.</p>
<p>Table of Ext4 specific ioctls</p>
<table border="1" class="docutils">
<colgroup>
<col width="37%" />
<col width="63%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Ioctl</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>EXT4_IOC_GETFLAGS</td>
<td>Get additional attributes associated with inode.
The ioctl argument is an integer bitfield, with
bit values described in ext4.h. This ioctl is an
alias for FS_IOC_GETFLAGS.</td>
</tr>
<tr class="row-odd"><td>EXT4_IOC_SETFLAGS</td>
<td>Set additional attributes associated with inode.
The ioctl argument is an integer bitfield, with
bit values described in ext4.h. This ioctl is an
alias for FS_IOC_SETFLAGS.</td>
</tr>
<tr class="row-even"><td>EXT4_IOC_GETVERSION</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>EXT4_IOC_GETVERSION_OLD</td>
<td>Get the inode i_generation number stored for
each inode. The i_generation number is normally
changed only when new inode is created and it is
particularly useful for network filesystems. The
‘_OLD’ version of this ioctl is an alias for
FS_IOC_GETVERSION.</td>
</tr>
<tr class="row-even"><td>EXT4_IOC_SETVERSION</td>
<td>&#160;</td>
</tr>
<tr class="row-odd"><td>EXT4_IOC_SETVERSION_OLD</td>
<td>Set the inode i_generation number stored for
each inode. The ‘_OLD’ version of this ioctl
is an alias for FS_IOC_SETVERSION.</td>
</tr>
<tr class="row-even"><td>EXT4_IOC_GROUP_EXTEND</td>
<td>This ioctl has the same purpose as the resize
mount option. It allows to resize filesystem
to the end of the last existing block group,
further resize has to be done with resize2fs,
either online, or offline. The argument points
to the unsigned logn number representing the
filesystem new block count.</td>
</tr>
<tr class="row-odd"><td>EXT4_IOC_MOVE_EXT</td>
<td>Move the block extents from orig_fd (the one
this ioctl is pointing to) to the donor_fd (the
one specified in move_extent structure passed
as an argument to this ioctl). Then, exchange
inode metadata between orig_fd and donor_fd.
This is especially useful for online
defragmentation, because the allocator has the
opportunity to allocate moved blocks better,
ideally into one contiguous extent.</td>
</tr>
<tr class="row-even"><td>EXT4_IOC_GROUP_ADD</td>
<td>Add a new group descriptor to an existing or
new group descriptor block. The new group
descriptor is described by ext4_new_group_input
structure, which is passed as an argument to
this ioctl. This is especially useful in
conjunction with EXT4_IOC_GROUP_EXTEND,
which allows online resize of the filesystem
to the end of the last existing block group.
Those two ioctls combined is used in userspace
online resize tool (e.g. resize2fs).</td>
</tr>
<tr class="row-odd"><td>EXT4_IOC_MIGRATE</td>
<td>This ioctl operates on the filesystem itself.
It converts (migrates) ext3 indirect block mapped
inode to ext4 extent mapped inode by walking
through indirect block mapping of the original
inode and converting contiguous block ranges
into ext4 extents of the temporary inode. Then,
inodes are swapped. This ioctl might help, when
migrating from ext3 to ext4 filesystem, however
suggestion is to create fresh ext4 filesystem
and copy data from the backup. Note, that
filesystem has to support extents for this ioctl
to work.</td>
</tr>
<tr class="row-even"><td>EXT4_IOC_ALLOC_DA_BLKS</td>
<td>Force all of the delay allocated blocks to be
allocated to preserve application-expected ext3
behaviour. Note that this will also start
triggering a write of the data blocks, but this
behaviour may change in the future as it is
not necessary and has been done this way only
for sake of simplicity.</td>
</tr>
<tr class="row-odd"><td>EXT4_IOC_RESIZE_FS</td>
<td>Resize the filesystem to a new size.  The number
of blocks of resized filesystem is passed in via
64 bit integer argument.  The kernel allocates
bitmaps and inode table, the userspace tool thus
just passes the new number of blocks.</td>
</tr>
<tr class="row-even"><td>EXT4_IOC_SWAP_BOOT</td>
<td>Swap i_blocks and associated attributes
(like i_blocks, i_size, i_flags, …) from
the specified inode with inode
EXT4_BOOT_LOADER_INO (#5). This is typically
used to store a boot loader in a secure part of
the filesystem, where it can’t be changed by a
normal user by accident.
The data blocks of the previous boot loader
will be associated with the given inode.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="references">
<h2>1.8. References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<dl class="docutils">
<dt>kernel source:  &lt;<a class="reference external" href="file:fs/ext4/">file:fs/ext4/</a>&gt;</dt>
<dd>&lt;<a class="reference external" href="file:fs/jbd2/">file:fs/jbd2/</a>&gt;</dd>
</dl>
<p>programs:       <a class="reference external" href="http://e2fsprogs.sourceforge.net/">http://e2fsprogs.sourceforge.net/</a></p>
<dl class="docutils">
<dt>useful links:   <a class="reference external" href="http://fedoraproject.org/wiki/ext3-devel">http://fedoraproject.org/wiki/ext3-devel</a></dt>
<dd><a class="reference external" href="http://www.bullopensource.org/ext4/">http://www.bullopensource.org/ext4/</a>
<a class="reference external" href="http://ext4.wiki.kernel.org/index.php/Main_Page">http://ext4.wiki.kernel.org/index.php/Main_Page</a>
<a class="reference external" href="http://fedoraproject.org/wiki/Features/Ext4">http://fedoraproject.org/wiki/Features/Ext4</a></dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="ondisk/index.html" class="btn btn-neutral float-right" title="2. Data Structures and Algorithms" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="index.html" class="btn btn-neutral" title="ext4 Filesystem" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../../',
              VERSION:'',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="../../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>