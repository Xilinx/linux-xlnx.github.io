

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Random Number Algorithm Definitions &mdash; The Linux Kernel  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Asymmetric Cipher Algorithm Definitions" href="api-akcipher.html" />
    <link rel="prev" title="Message Digest Algorithm Definitions" href="api-digest.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                4.14.0-xilinx-v2018.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/index.html">The Linux kernel user’s and administrator’s guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../userspace-api/index.html">The Linux kernel user-space API guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../process/index.html">Working with the kernel development community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
</ul>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../driver-api/index.html">The Linux driver implementer’s API guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../media/index.html">Linux Media Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../networking/index.html">Linux Networking Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input/index.html">The Linux Input Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu/index.html">Linux GPU Driver Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security/index.html">Security Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sound/index.html">Linux Sound Subsystem Documentation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Linux Kernel Crypto API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="intro.html">Kernel Crypto API Interface Specification</a></li>
<li class="toctree-l2"><a class="reference internal" href="architecture.html">Kernel Crypto API Architecture</a></li>
<li class="toctree-l2"><a class="reference internal" href="devel-algos.html">Developing Cipher Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="userspace-if.html">User Space Interface</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="api.html">Programming Interface</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="api-skcipher.html">Block Cipher Algorithm Definitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-skcipher.html#symmetric-key-cipher-api">Symmetric Key Cipher API</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-skcipher.html#symmetric-key-cipher-request-handle">Symmetric Key Cipher Request Handle</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-skcipher.html#single-block-cipher-api">Single Block Cipher API</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-skcipher.html#asynchronous-block-cipher-api-deprecated">Asynchronous Block Cipher API - Deprecated</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-skcipher.html#asynchronous-cipher-request-handle-deprecated">Asynchronous Cipher Request Handle - Deprecated</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-skcipher.html#synchronous-block-cipher-api-deprecated">Synchronous Block Cipher API - Deprecated</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-aead.html">Authenticated Encryption With Associated Data (AEAD) Algorithm Definitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-aead.html#authenticated-encryption-with-associated-data-aead-cipher-api">Authenticated Encryption With Associated Data (AEAD) Cipher API</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-aead.html#asynchronous-aead-request-handle">Asynchronous AEAD Request Handle</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-digest.html">Message Digest Algorithm Definitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-digest.html#asynchronous-message-digest-api">Asynchronous Message Digest API</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-digest.html#asynchronous-hash-request-handle">Asynchronous Hash Request Handle</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-digest.html#synchronous-message-digest-api">Synchronous Message Digest API</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Random Number Algorithm Definitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#crypto-api-random-number-api">Crypto API Random Number API</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-akcipher.html">Asymmetric Cipher Algorithm Definitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-akcipher.html#asymmetric-cipher-api">Asymmetric Cipher API</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-akcipher.html#asymmetric-cipher-request-handle">Asymmetric Cipher Request Handle</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-kpp.html">Key-agreement Protocol Primitives (KPP) Cipher Algorithm Definitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-kpp.html#key-agreement-protocol-primitives-kpp-cipher-api">Key-agreement Protocol Primitives (KPP) Cipher API</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-kpp.html#key-agreement-protocol-primitives-kpp-cipher-request-handle">Key-agreement Protocol Primitives (KPP) Cipher Request Handle</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-kpp.html#ecdh-helper-functions">ECDH Helper Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="api-kpp.html#dh-helper-functions">DH Helper Functions</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api-samples.html">Code Examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../filesystems/index.html">Linux Filesystems API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../sh/index.html">SuperH Interfaces Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../translations/ko_KR/index.html">Korean translations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../translations/zh_CN/index.html">Chinese translations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../translations/ja_JP/index.html">Japanese translations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">Linux Kernel Crypto API</a> &raquo;</li>
        
          <li><a href="api.html">Programming Interface</a> &raquo;</li>
        
      <li>Random Number Algorithm Definitions</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/crypto/api-rng.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="random-number-algorithm-definitions">
<h1>Random Number Algorithm Definitions<a class="headerlink" href="#random-number-algorithm-definitions" title="Permalink to this headline">¶</a></h1>
<dl class="type">
<dt id="c.rng_alg">
struct <code class="descname">rng_alg</code><a class="headerlink" href="#c.rng_alg" title="Permalink to this definition">¶</a></dt>
<dd><p>random number generator definition</p>
</dd></dl>

<p><strong>Definition</strong></p>
<div class="highlight-none"><div class="highlight"><pre><span></span>struct rng_alg {
  int (* generate) (struct crypto_rng *tfm,const u8 *src, unsigned int slen, u8 *dst, unsigned int dlen);
  int (* seed) (struct crypto_rng *tfm, const u8 *seed, unsigned int slen);
  void (* set_ent) (struct crypto_rng *tfm, const u8 *data, unsigned int len);
  unsigned int seedsize;
  struct crypto_alg base;
};
</pre></div>
</div>
<p><strong>Members</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">generate</span></code></dt>
<dd>The function defined by this variable obtains a
random number. The random number generator transform
must generate the random number out of the context
provided with this call, plus any additional data
if provided to the call.</dd>
<dt><code class="docutils literal"><span class="pre">seed</span></code></dt>
<dd>Seed or reseed the random number generator.  With the
invocation of this function call, the random number
generator shall become ready for generation.  If the
random number generator requires a seed for setting
up a new state, the seed must be provided by the
consumer while invoking this function. The required
size of the seed is defined with <strong>seedsize</strong> .</dd>
<dt><code class="docutils literal"><span class="pre">set_ent</span></code></dt>
<dd>Set entropy that would otherwise be obtained from
entropy source.  Internal use only.</dd>
<dt><code class="docutils literal"><span class="pre">seedsize</span></code></dt>
<dd>The seed size required for a random number generator
initialization defined with this variable. Some
random number generators does not require a seed
as the seeding is implemented internally without
the need of support by the consumer. In this case,
the seed size is set to zero.</dd>
<dt><code class="docutils literal"><span class="pre">base</span></code></dt>
<dd>Common crypto API algorithm data structure.</dd>
</dl>
</div>
<div class="section" id="crypto-api-random-number-api">
<h1>Crypto API Random Number API<a class="headerlink" href="#crypto-api-random-number-api" title="Permalink to this headline">¶</a></h1>
<p>The random number generator API is used with the ciphers of type
CRYPTO_ALG_TYPE_RNG (listed as type “rng” in /proc/crypto)</p>
<dl class="function">
<dt id="c.crypto_alloc_rng">
struct crypto_rng * <code class="descname">crypto_alloc_rng</code><span class="sig-paren">(</span>const char *<em>&nbsp;alg_name</em>, u32<em>&nbsp;type</em>, u32<em>&nbsp;mask</em><span class="sig-paren">)</span><a class="headerlink" href="#c.crypto_alloc_rng" title="Permalink to this definition">¶</a></dt>
<dd><ul class="simple">
<li>allocate RNG handle</li>
</ul>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">const</span> <span class="pre">char</span> <span class="pre">*</span> <span class="pre">alg_name</span></code></dt>
<dd>is the cra_name / name or cra_driver_name / driver name of the
message digest cipher</dd>
<dt><code class="docutils literal"><span class="pre">u32</span> <span class="pre">type</span></code></dt>
<dd>specifies the type of the cipher</dd>
<dt><code class="docutils literal"><span class="pre">u32</span> <span class="pre">mask</span></code></dt>
<dd>specifies the mask for the cipher</dd>
</dl>
<p><strong>Description</strong></p>
<p>Allocate a cipher handle for a random number generator. The returned struct
crypto_rng is the cipher handle that is required for any subsequent
API invocation for that random number generator.</p>
<p>For all random number generators, this call creates a new private copy of
the random number generator that does not share a state with other
instances. The only exception is the “krng” random number generator which
is a kernel crypto API use case for the <code class="xref c c-func docutils literal"><span class="pre">get_random_bytes()</span></code> function of the
/dev/random driver.</p>
<p><strong>Return</strong></p>
<dl class="docutils">
<dt>allocated cipher handle in case of success; <code class="xref c c-func docutils literal"><span class="pre">IS_ERR()</span></code> is true in case</dt>
<dd>of an error, <code class="xref c c-func docutils literal"><span class="pre">PTR_ERR()</span></code> returns the error code.</dd>
</dl>
<dl class="function">
<dt id="c.crypto_rng_alg">
struct <a class="reference internal" href="#c.rng_alg" title="rng_alg">rng_alg</a> * <code class="descname">crypto_rng_alg</code><span class="sig-paren">(</span>struct crypto_rng *<em>&nbsp;tfm</em><span class="sig-paren">)</span><a class="headerlink" href="#c.crypto_rng_alg" title="Permalink to this definition">¶</a></dt>
<dd><p>obtain name of RNG</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">crypto_rng</span> <span class="pre">*</span> <span class="pre">tfm</span></code></dt>
<dd>cipher handle</dd>
</dl>
<p><strong>Description</strong></p>
<p>Return the generic name (cra_name) of the initialized random number generator</p>
<p><strong>Return</strong></p>
<p>generic name string</p>
<dl class="function">
<dt id="c.crypto_free_rng">
void <code class="descname">crypto_free_rng</code><span class="sig-paren">(</span>struct crypto_rng *<em>&nbsp;tfm</em><span class="sig-paren">)</span><a class="headerlink" href="#c.crypto_free_rng" title="Permalink to this definition">¶</a></dt>
<dd><p>zeroize and free RNG handle</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">crypto_rng</span> <span class="pre">*</span> <span class="pre">tfm</span></code></dt>
<dd>cipher handle to be freed</dd>
</dl>
<dl class="function">
<dt id="c.crypto_rng_generate">
int <code class="descname">crypto_rng_generate</code><span class="sig-paren">(</span>struct crypto_rng *<em>&nbsp;tfm</em>, const u8 *<em>&nbsp;src</em>, unsigned int<em>&nbsp;slen</em>, u8 *<em>&nbsp;dst</em>, unsigned int<em>&nbsp;dlen</em><span class="sig-paren">)</span><a class="headerlink" href="#c.crypto_rng_generate" title="Permalink to this definition">¶</a></dt>
<dd><p>get random number</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">crypto_rng</span> <span class="pre">*</span> <span class="pre">tfm</span></code></dt>
<dd>cipher handle</dd>
<dt><code class="docutils literal"><span class="pre">const</span> <span class="pre">u8</span> <span class="pre">*</span> <span class="pre">src</span></code></dt>
<dd>Input buffer holding additional data, may be NULL</dd>
<dt><code class="docutils literal"><span class="pre">unsigned</span> <span class="pre">int</span> <span class="pre">slen</span></code></dt>
<dd>Length of additional data</dd>
<dt><code class="docutils literal"><span class="pre">u8</span> <span class="pre">*</span> <span class="pre">dst</span></code></dt>
<dd>output buffer holding the random numbers</dd>
<dt><code class="docutils literal"><span class="pre">unsigned</span> <span class="pre">int</span> <span class="pre">dlen</span></code></dt>
<dd>length of the output buffer</dd>
</dl>
<p><strong>Description</strong></p>
<p>This function fills the caller-allocated buffer with random
numbers using the random number generator referenced by the
cipher handle.</p>
<p><strong>Return</strong></p>
<p>0 function was successful; &lt; 0 if an error occurred</p>
<dl class="function">
<dt id="c.crypto_rng_get_bytes">
int <code class="descname">crypto_rng_get_bytes</code><span class="sig-paren">(</span>struct crypto_rng *<em>&nbsp;tfm</em>, u8 *<em>&nbsp;rdata</em>, unsigned int<em>&nbsp;dlen</em><span class="sig-paren">)</span><a class="headerlink" href="#c.crypto_rng_get_bytes" title="Permalink to this definition">¶</a></dt>
<dd><p>get random number</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">crypto_rng</span> <span class="pre">*</span> <span class="pre">tfm</span></code></dt>
<dd>cipher handle</dd>
<dt><code class="docutils literal"><span class="pre">u8</span> <span class="pre">*</span> <span class="pre">rdata</span></code></dt>
<dd>output buffer holding the random numbers</dd>
<dt><code class="docutils literal"><span class="pre">unsigned</span> <span class="pre">int</span> <span class="pre">dlen</span></code></dt>
<dd>length of the output buffer</dd>
</dl>
<p><strong>Description</strong></p>
<p>This function fills the caller-allocated buffer with random numbers using the
random number generator referenced by the cipher handle.</p>
<p><strong>Return</strong></p>
<p>0 function was successful; &lt; 0 if an error occurred</p>
<dl class="function">
<dt id="c.crypto_rng_reset">
int <code class="descname">crypto_rng_reset</code><span class="sig-paren">(</span>struct crypto_rng *<em>&nbsp;tfm</em>, const u8 *<em>&nbsp;seed</em>, unsigned int<em>&nbsp;slen</em><span class="sig-paren">)</span><a class="headerlink" href="#c.crypto_rng_reset" title="Permalink to this definition">¶</a></dt>
<dd><p>re-initialize the RNG</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">crypto_rng</span> <span class="pre">*</span> <span class="pre">tfm</span></code></dt>
<dd>cipher handle</dd>
<dt><code class="docutils literal"><span class="pre">const</span> <span class="pre">u8</span> <span class="pre">*</span> <span class="pre">seed</span></code></dt>
<dd>seed input data</dd>
<dt><code class="docutils literal"><span class="pre">unsigned</span> <span class="pre">int</span> <span class="pre">slen</span></code></dt>
<dd>length of the seed input data</dd>
</dl>
<p><strong>Description</strong></p>
<p>The reset function completely re-initializes the random number generator
referenced by the cipher handle by clearing the current state. The new state
is initialized with the caller provided seed or automatically, depending
on the random number generator type (the ANSI X9.31 RNG requires
caller-provided seed, the SP800-90A DRBGs perform an automatic seeding).
The seed is provided as a parameter to this function call. The provided seed
should have the length of the seed size defined for the random number
generator as defined by crypto_rng_seedsize.</p>
<p><strong>Return</strong></p>
<p>0 if the setting of the key was successful; &lt; 0 if an error occurred</p>
<dl class="function">
<dt id="c.crypto_rng_seedsize">
int <code class="descname">crypto_rng_seedsize</code><span class="sig-paren">(</span>struct crypto_rng *<em>&nbsp;tfm</em><span class="sig-paren">)</span><a class="headerlink" href="#c.crypto_rng_seedsize" title="Permalink to this definition">¶</a></dt>
<dd><p>obtain seed size of RNG</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">crypto_rng</span> <span class="pre">*</span> <span class="pre">tfm</span></code></dt>
<dd>cipher handle</dd>
</dl>
<p><strong>Description</strong></p>
<p>The function returns the seed size for the random number generator
referenced by the cipher handle. This value may be zero if the random
number generator does not implement or require a reseeding. For example,
the SP800-90A DRBGs implement an automated reseeding after reaching a
pre-defined threshold.</p>
<p><strong>Return</strong></p>
<p>seed size for the random number generator</p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="api-akcipher.html" class="btn btn-neutral float-right" title="Asymmetric Cipher Algorithm Definitions" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="api-digest.html" class="btn btn-neutral" title="Message Digest Algorithm Definitions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>