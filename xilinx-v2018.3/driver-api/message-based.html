

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Message-based devices &mdash; The Linux Kernel  documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/theme_overrides.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Sound Devices" href="sound.html" />
    <link rel="prev" title="Device links" href="device_link.html" /> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> The Linux Kernel
          

          
          </a>

          
            
            
              <div class="version">
                4.14.0-xilinx-v2018.3
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../admin-guide/index.html">The Linux kernel user’s and administrator’s guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../userspace-api/index.html">The Linux kernel user-space API guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../process/index.html">Working with the kernel development community</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev-tools/index.html">Development tools for the kernel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../doc-guide/index.html">How to write kernel documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../kernel-hacking/index.html">Kernel Hacking Guides</a></li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">The Linux driver implementer’s API guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="basics.html">Driver Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="infrastructure.html">Device drivers infrastructure</a></li>
<li class="toctree-l2"><a class="reference internal" href="pm/index.html">Device Power Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="device-io.html">Bus-Independent Device Accesses</a></li>
<li class="toctree-l2"><a class="reference internal" href="dma-buf.html">Buffer Sharing and Synchronization</a></li>
<li class="toctree-l2"><a class="reference internal" href="device_link.html">Device links</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Message-based devices</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fusion-message-devices">Fusion message devices</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="sound.html">Sound Devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="frame-buffer.html">Frame Buffer Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="regulator.html">Voltage and current regulator API</a></li>
<li class="toctree-l2"><a class="reference internal" href="iio/index.html">Industrial I/O</a></li>
<li class="toctree-l2"><a class="reference internal" href="input.html">Input Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="usb/index.html">Linux USB API</a></li>
<li class="toctree-l2"><a class="reference internal" href="pci.html">PCI Support Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="pci.html#pci-hotplug-support-library">PCI Hotplug Support Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="spi.html">Serial Peripheral Interface (SPI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="i2c.html">I<sup>2</sup>C and SMBus Subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="hsi.html">High Speed Synchronous Serial Interface (HSI)</a></li>
<li class="toctree-l2"><a class="reference internal" href="edac.html">Error Detection And Correction (EDAC) Devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="scsi.html">SCSI Interfaces Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="libata.html">libATA Developer’s Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="mtdnand.html">MTD NAND Driver Programming Interface</a></li>
<li class="toctree-l2"><a class="reference internal" href="miscellaneous.html">Parallel Port Devices</a></li>
<li class="toctree-l2"><a class="reference internal" href="miscellaneous.html#x50-uart-driver">16x50 UART Driver</a></li>
<li class="toctree-l2"><a class="reference internal" href="miscellaneous.html#pulse-width-modulation-pwm">Pulse-Width Modulation (PWM)</a></li>
<li class="toctree-l2"><a class="reference internal" href="w1.html">W1: Dallas’ 1-wire bus</a></li>
<li class="toctree-l2"><a class="reference internal" href="rapidio.html">RapidIO Subsystem Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="s390-drivers.html">Writing s390 channel device drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="vme.html">VME Device Drivers</a></li>
<li class="toctree-l2"><a class="reference internal" href="80211/index.html">Linux 802.11 Driver Developer’s Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="uio-howto.html">The Userspace I/O HOWTO</a></li>
<li class="toctree-l2"><a class="reference internal" href="firmware/index.html">Linux Firmware API</a></li>
<li class="toctree-l2"><a class="reference internal" href="pinctl.html">PINCTRL (PIN CONTROL) subsystem</a></li>
<li class="toctree-l2"><a class="reference internal" href="gpio.html">General Purpose Input/Output (GPIO)</a></li>
<li class="toctree-l2"><a class="reference internal" href="misc_devices.html">Miscellaneous Devices</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../core-api/index.html">Core API Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../media/index.html">Linux Media Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../networking/index.html">Linux Networking Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input/index.html">The Linux Input Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../gpu/index.html">Linux GPU Driver Developer’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../security/index.html">Security Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sound/index.html">Linux Sound Subsystem Documentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../crypto/index.html">Linux Kernel Crypto API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../filesystems/index.html">Linux Filesystems API</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../sh/index.html">SuperH Interfaces Guide</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../translations/ko_KR/index.html">Korean translations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../translations/zh_CN/index.html">Chinese translations</a></li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../translations/ja_JP/index.html">Japanese translations</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">The Linux Kernel</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="index.html">The Linux driver implementer’s API guide</a> &raquo;</li>
        
      <li>Message-based devices</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/driver-api/message-based.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="message-based-devices">
<h1>Message-based devices<a class="headerlink" href="#message-based-devices" title="Permalink to this headline">¶</a></h1>
<div class="section" id="fusion-message-devices">
<h2>Fusion message devices<a class="headerlink" href="#fusion-message-devices" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="c.mpt_register">
u8 <code class="descname">mpt_register</code><span class="sig-paren">(</span>MPT_CALLBACK<em>&nbsp;cbfunc</em>, MPT_DRIVER_CLASS<em>&nbsp;dclass</em>, char *<em>&nbsp;func_name</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_register" title="Permalink to this definition">¶</a></dt>
<dd><p>Register protocol-specific main callback handler.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">MPT_CALLBACK</span> <span class="pre">cbfunc</span></code></dt>
<dd>callback function pointer</dd>
<dt><code class="docutils literal"><span class="pre">MPT_DRIVER_CLASS</span> <span class="pre">dclass</span></code></dt>
<dd>Protocol driver’s class (<code class="docutils literal"><span class="pre">MPT_DRIVER_CLASS</span></code> enum value)</dd>
<dt><code class="docutils literal"><span class="pre">char</span> <span class="pre">*</span> <span class="pre">func_name</span></code></dt>
<dd>call function’s name</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div>This routine is called by a protocol-specific driver (SCSI host,
LAN, SCSI target) to register its reply callback routine.  Each
protocol-specific driver must do this before it will be able to
use any IOC resources, such as obtaining request frames.</div></blockquote>
<p><strong>NOTES</strong></p>
<dl class="docutils">
<dt>The SCSI protocol driver currently calls this routine thrice</dt>
<dd><p class="first">in order to register separate callbacks; one for “normal” SCSI IO;
one for MptScsiTaskMgmt requests; one for Scan/DV requests.</p>
<p class="last">Returns u8 valued “handle” in the range (and S.O.D. order)
{N,…,7,6,5,…,1} if successful.
A return value of MPT_MAX_PROTOCOL_DRIVERS (including zero!) should be
considered an error by the caller.</p>
</dd>
</dl>
<dl class="function">
<dt id="c.mpt_deregister">
void <code class="descname">mpt_deregister</code><span class="sig-paren">(</span>u8<em>&nbsp;cb_idx</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_deregister" title="Permalink to this definition">¶</a></dt>
<dd><p>Deregister a protocol drivers resources.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt>
<dd>previously registered callback handle</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div>Each protocol-specific driver should call this routine when its
module is unloaded.</div></blockquote>
<dl class="function">
<dt id="c.mpt_event_register">
int <code class="descname">mpt_event_register</code><span class="sig-paren">(</span>u8<em>&nbsp;cb_idx</em>, MPT_EVHANDLER<em>&nbsp;ev_cbfunc</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_event_register" title="Permalink to this definition">¶</a></dt>
<dd><p>Register protocol-specific event callback handler.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt>
<dd>previously registered (via mpt_register) callback handle</dd>
<dt><code class="docutils literal"><span class="pre">MPT_EVHANDLER</span> <span class="pre">ev_cbfunc</span></code></dt>
<dd>callback function</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div><p>This routine can be called by one or more protocol-specific drivers
if/when they choose to be notified of MPT events.</p>
<p>Returns 0 for success.</p>
</div></blockquote>
<dl class="function">
<dt id="c.mpt_event_deregister">
void <code class="descname">mpt_event_deregister</code><span class="sig-paren">(</span>u8<em>&nbsp;cb_idx</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_event_deregister" title="Permalink to this definition">¶</a></dt>
<dd><p>Deregister protocol-specific event callback handler</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt>
<dd>previously registered callback handle</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div>Each protocol-specific driver should call this routine
when it does not (or can no longer) handle events,
or when its module is unloaded.</div></blockquote>
<dl class="function">
<dt id="c.mpt_reset_register">
int <code class="descname">mpt_reset_register</code><span class="sig-paren">(</span>u8<em>&nbsp;cb_idx</em>, MPT_RESETHANDLER<em>&nbsp;reset_func</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_reset_register" title="Permalink to this definition">¶</a></dt>
<dd><p>Register protocol-specific IOC reset handler.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt>
<dd>previously registered (via mpt_register) callback handle</dd>
<dt><code class="docutils literal"><span class="pre">MPT_RESETHANDLER</span> <span class="pre">reset_func</span></code></dt>
<dd>reset function</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div><p>This routine can be called by one or more protocol-specific drivers
if/when they choose to be notified of IOC resets.</p>
<p>Returns 0 for success.</p>
</div></blockquote>
<dl class="function">
<dt id="c.mpt_reset_deregister">
void <code class="descname">mpt_reset_deregister</code><span class="sig-paren">(</span>u8<em>&nbsp;cb_idx</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_reset_deregister" title="Permalink to this definition">¶</a></dt>
<dd><p>Deregister protocol-specific IOC reset handler.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt>
<dd>previously registered callback handle</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div>Each protocol-specific driver should call this routine
when it does not (or can no longer) handle IOC reset handling,
or when its module is unloaded.</div></blockquote>
<dl class="function">
<dt id="c.mpt_device_driver_register">
int <code class="descname">mpt_device_driver_register</code><span class="sig-paren">(</span>struct mpt_pci_driver *<em>&nbsp;dd_cbfunc</em>, u8<em>&nbsp;cb_idx</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_device_driver_register" title="Permalink to this definition">¶</a></dt>
<dd><p>Register device driver hooks</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">mpt_pci_driver</span> <span class="pre">*</span> <span class="pre">dd_cbfunc</span></code></dt>
<dd>driver callbacks struct</dd>
<dt><code class="docutils literal"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt>
<dd>MPT protocol driver index</dd>
</dl>
<dl class="function">
<dt id="c.mpt_device_driver_deregister">
void <code class="descname">mpt_device_driver_deregister</code><span class="sig-paren">(</span>u8<em>&nbsp;cb_idx</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_device_driver_deregister" title="Permalink to this definition">¶</a></dt>
<dd><p>DeRegister device driver hooks</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt>
<dd>MPT protocol driver index</dd>
</dl>
<dl class="function">
<dt id="c.mpt_get_msg_frame">
MPT_FRAME_HDR* <code class="descname">mpt_get_msg_frame</code><span class="sig-paren">(</span>u8<em>&nbsp;cb_idx</em>, MPT_ADAPTER *<em>&nbsp;ioc</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_get_msg_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtain an MPT request frame from the pool</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt>
<dd>Handle of registered MPT protocol driver</dd>
<dt><code class="docutils literal"><span class="pre">MPT_ADAPTER</span> <span class="pre">*</span> <span class="pre">ioc</span></code></dt>
<dd>Pointer to MPT adapter structure</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div><p>Obtain an MPT request frame from the pool (of 1024) that are
allocated per MPT adapter.</p>
<p>Returns pointer to a MPT request frame or <code class="docutils literal"><span class="pre">NULL</span></code> if none are available
or IOC is not active.</p>
</div></blockquote>
<dl class="function">
<dt id="c.mpt_put_msg_frame">
void <code class="descname">mpt_put_msg_frame</code><span class="sig-paren">(</span>u8<em>&nbsp;cb_idx</em>, MPT_ADAPTER *<em>&nbsp;ioc</em>, MPT_FRAME_HDR *<em>&nbsp;mf</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_put_msg_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a protocol-specific MPT request frame to an IOC</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt>
<dd>Handle of registered MPT protocol driver</dd>
<dt><code class="docutils literal"><span class="pre">MPT_ADAPTER</span> <span class="pre">*</span> <span class="pre">ioc</span></code></dt>
<dd>Pointer to MPT adapter structure</dd>
<dt><code class="docutils literal"><span class="pre">MPT_FRAME_HDR</span> <span class="pre">*</span> <span class="pre">mf</span></code></dt>
<dd>Pointer to MPT request frame</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div>This routine posts an MPT request frame to the request post FIFO of a
specific MPT adapter.</div></blockquote>
<dl class="function">
<dt id="c.mpt_put_msg_frame_hi_pri">
void <code class="descname">mpt_put_msg_frame_hi_pri</code><span class="sig-paren">(</span>u8<em>&nbsp;cb_idx</em>, MPT_ADAPTER *<em>&nbsp;ioc</em>, MPT_FRAME_HDR *<em>&nbsp;mf</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_put_msg_frame_hi_pri" title="Permalink to this definition">¶</a></dt>
<dd><p>Send a hi-pri protocol-specific MPT request frame</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt>
<dd>Handle of registered MPT protocol driver</dd>
<dt><code class="docutils literal"><span class="pre">MPT_ADAPTER</span> <span class="pre">*</span> <span class="pre">ioc</span></code></dt>
<dd>Pointer to MPT adapter structure</dd>
<dt><code class="docutils literal"><span class="pre">MPT_FRAME_HDR</span> <span class="pre">*</span> <span class="pre">mf</span></code></dt>
<dd>Pointer to MPT request frame</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div><p>Send a protocol-specific MPT request frame to an IOC using
hi-priority request queue.</p>
<p>This routine posts an MPT request frame to the request post FIFO of a
specific MPT adapter.</p>
</div></blockquote>
<dl class="function">
<dt id="c.mpt_free_msg_frame">
void <code class="descname">mpt_free_msg_frame</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>&nbsp;ioc</em>, MPT_FRAME_HDR *<em>&nbsp;mf</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_free_msg_frame" title="Permalink to this definition">¶</a></dt>
<dd><p>Place MPT request frame back on FreeQ.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">MPT_ADAPTER</span> <span class="pre">*</span> <span class="pre">ioc</span></code></dt>
<dd>Pointer to MPT adapter structure</dd>
<dt><code class="docutils literal"><span class="pre">MPT_FRAME_HDR</span> <span class="pre">*</span> <span class="pre">mf</span></code></dt>
<dd>Pointer to MPT request frame</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div>This routine places a MPT request frame back on the MPT adapter’s
FreeQ.</div></blockquote>
<dl class="function">
<dt id="c.mpt_send_handshake_request">
int <code class="descname">mpt_send_handshake_request</code><span class="sig-paren">(</span>u8<em>&nbsp;cb_idx</em>, MPT_ADAPTER *<em>&nbsp;ioc</em>, int<em>&nbsp;reqBytes</em>, u32 *<em>&nbsp;req</em>, int<em>&nbsp;sleepFlag</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_send_handshake_request" title="Permalink to this definition">¶</a></dt>
<dd><p>Send MPT request via doorbell handshake method.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">u8</span> <span class="pre">cb_idx</span></code></dt>
<dd>Handle of registered MPT protocol driver</dd>
<dt><code class="docutils literal"><span class="pre">MPT_ADAPTER</span> <span class="pre">*</span> <span class="pre">ioc</span></code></dt>
<dd>Pointer to MPT adapter structure</dd>
<dt><code class="docutils literal"><span class="pre">int</span> <span class="pre">reqBytes</span></code></dt>
<dd>Size of the request in bytes</dd>
<dt><code class="docutils literal"><span class="pre">u32</span> <span class="pre">*</span> <span class="pre">req</span></code></dt>
<dd>Pointer to MPT request frame</dd>
<dt><code class="docutils literal"><span class="pre">int</span> <span class="pre">sleepFlag</span></code></dt>
<dd>Use schedule if CAN_SLEEP else use udelay.</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div>This routine is used exclusively to send MptScsiTaskMgmt
requests since they are required to be sent via doorbell handshake.</div></blockquote>
<p><strong>NOTE</strong></p>
<dl class="docutils">
<dt>It is the callers responsibility to byte-swap fields in the</dt>
<dd><p class="first">request which are greater than 1 byte in size.</p>
<p class="last">Returns 0 for success, non-zero for failure.</p>
</dd>
</dl>
<dl class="function">
<dt id="c.mpt_verify_adapter">
int <code class="descname">mpt_verify_adapter</code><span class="sig-paren">(</span>int<em>&nbsp;iocid</em>, MPT_ADAPTER **<em>&nbsp;iocpp</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_verify_adapter" title="Permalink to this definition">¶</a></dt>
<dd><p>Given IOC identifier, set pointer to its adapter structure.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">int</span> <span class="pre">iocid</span></code></dt>
<dd>IOC unique identifier (integer)</dd>
<dt><code class="docutils literal"><span class="pre">MPT_ADAPTER</span> <span class="pre">**</span> <span class="pre">iocpp</span></code></dt>
<dd>Pointer to pointer to IOC adapter</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div><p>Given a unique IOC identifier, set pointer to the associated MPT
adapter structure.</p>
<p>Returns iocid and sets iocpp if iocid is found.
Returns -1 if iocid is not found.</p>
</div></blockquote>
<dl class="function">
<dt id="c.mpt_attach">
int <code class="descname">mpt_attach</code><span class="sig-paren">(</span>struct pci_dev *<em>&nbsp;pdev</em>, const struct pci_device_id *<em>&nbsp;id</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_attach" title="Permalink to this definition">¶</a></dt>
<dd><p>Install a PCI intelligent MPT adapter.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">pci_dev</span> <span class="pre">*</span> <span class="pre">pdev</span></code></dt>
<dd>Pointer to pci_dev structure</dd>
<dt><code class="docutils literal"><span class="pre">const</span> <span class="pre">struct</span> <span class="pre">pci_device_id</span> <span class="pre">*</span> <span class="pre">id</span></code></dt>
<dd>PCI device ID information</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div><p>This routine performs all the steps necessary to bring the IOC of
a MPT adapter to a OPERATIONAL state.  This includes registering
memory regions, registering the interrupt, and allocating request
and reply memory pools.</p>
<p>This routine also pre-fetches the LAN MAC address of a Fibre Channel
MPT adapter.</p>
<p>Returns 0 for success, non-zero for failure.</p>
<p>TODO: Add support for polled controllers</p>
</div></blockquote>
<dl class="function">
<dt id="c.mpt_detach">
void <code class="descname">mpt_detach</code><span class="sig-paren">(</span>struct pci_dev *<em>&nbsp;pdev</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_detach" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove a PCI intelligent MPT adapter.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">pci_dev</span> <span class="pre">*</span> <span class="pre">pdev</span></code></dt>
<dd>Pointer to pci_dev structure</dd>
</dl>
<dl class="function">
<dt id="c.mpt_suspend">
int <code class="descname">mpt_suspend</code><span class="sig-paren">(</span>struct pci_dev *<em>&nbsp;pdev</em>, pm_message_t<em>&nbsp;state</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_suspend" title="Permalink to this definition">¶</a></dt>
<dd><p>Fusion MPT base driver suspend routine.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">pci_dev</span> <span class="pre">*</span> <span class="pre">pdev</span></code></dt>
<dd>Pointer to pci_dev structure</dd>
<dt><code class="docutils literal"><span class="pre">pm_message_t</span> <span class="pre">state</span></code></dt>
<dd>new state to enter</dd>
</dl>
<dl class="function">
<dt id="c.mpt_resume">
int <code class="descname">mpt_resume</code><span class="sig-paren">(</span>struct pci_dev *<em>&nbsp;pdev</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_resume" title="Permalink to this definition">¶</a></dt>
<dd><p>Fusion MPT base driver resume routine.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">pci_dev</span> <span class="pre">*</span> <span class="pre">pdev</span></code></dt>
<dd>Pointer to pci_dev structure</dd>
</dl>
<dl class="function">
<dt id="c.mpt_GetIocState">
u32 <code class="descname">mpt_GetIocState</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>&nbsp;ioc</em>, int<em>&nbsp;cooked</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_GetIocState" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the current state of a MPT adapter.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">MPT_ADAPTER</span> <span class="pre">*</span> <span class="pre">ioc</span></code></dt>
<dd>Pointer to MPT_ADAPTER structure</dd>
<dt><code class="docutils literal"><span class="pre">int</span> <span class="pre">cooked</span></code></dt>
<dd>Request raw or cooked IOC state</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div>Returns all IOC Doorbell register bits if cooked==0, else just the
Doorbell bits in MPI_IOC_STATE_MASK.</div></blockquote>
<dl class="function">
<dt id="c.mpt_alloc_fw_memory">
int <code class="descname">mpt_alloc_fw_memory</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>&nbsp;ioc</em>, int<em>&nbsp;size</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_alloc_fw_memory" title="Permalink to this definition">¶</a></dt>
<dd><p>allocate firmware memory</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">MPT_ADAPTER</span> <span class="pre">*</span> <span class="pre">ioc</span></code></dt>
<dd>Pointer to MPT_ADAPTER structure</dd>
<dt><code class="docutils literal"><span class="pre">int</span> <span class="pre">size</span></code></dt>
<dd>total FW bytes</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div><p>If memory has already been allocated, the same (cached) value
is returned.</p>
<p>Return 0 if successful, or non-zero for failure</p>
</div></blockquote>
<dl class="function">
<dt id="c.mpt_free_fw_memory">
void <code class="descname">mpt_free_fw_memory</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>&nbsp;ioc</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_free_fw_memory" title="Permalink to this definition">¶</a></dt>
<dd><p>free firmware memory</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">MPT_ADAPTER</span> <span class="pre">*</span> <span class="pre">ioc</span></code></dt>
<dd>Pointer to MPT_ADAPTER structure</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div>If alt_img is NULL, delete from ioc structure.
Else, delete a secondary image in same format.</div></blockquote>
<dl class="function">
<dt id="c.mptbase_sas_persist_operation">
int <code class="descname">mptbase_sas_persist_operation</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>&nbsp;ioc</em>, u8<em>&nbsp;persist_opcode</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mptbase_sas_persist_operation" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform operation on SAS Persistent Table</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">MPT_ADAPTER</span> <span class="pre">*</span> <span class="pre">ioc</span></code></dt>
<dd>Pointer to MPT_ADAPTER structure</dd>
<dt><code class="docutils literal"><span class="pre">u8</span> <span class="pre">persist_opcode</span></code></dt>
<dd>see below</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div><dl class="docutils">
<dt>MPI_SAS_OP_CLEAR_NOT_PRESENT - Free all persist TargetID mappings for</dt>
<dd>devices not currently present.</dd>
</dl>
<p>MPI_SAS_OP_CLEAR_ALL_PERSISTENT - Clear al persist TargetID mappings</p>
</div></blockquote>
<p><strong>NOTE</strong></p>
<p>Don’t use not this function during interrupt time.</p>
<blockquote>
<div>Returns 0 for success, non-zero error</div></blockquote>
<dl class="function">
<dt id="c.mpt_raid_phys_disk_pg0">
int <code class="descname">mpt_raid_phys_disk_pg0</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>&nbsp;ioc</em>, u8<em>&nbsp;phys_disk_num</em>, RaidPhysDiskPage0_t *<em>&nbsp;phys_disk</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_raid_phys_disk_pg0" title="Permalink to this definition">¶</a></dt>
<dd><p>returns phys disk page zero</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">MPT_ADAPTER</span> <span class="pre">*</span> <span class="pre">ioc</span></code></dt>
<dd>Pointer to a Adapter Structure</dd>
<dt><code class="docutils literal"><span class="pre">u8</span> <span class="pre">phys_disk_num</span></code></dt>
<dd>io unit unique phys disk num generated by the ioc</dd>
<dt><code class="docutils literal"><span class="pre">RaidPhysDiskPage0_t</span> <span class="pre">*</span> <span class="pre">phys_disk</span></code></dt>
<dd>requested payload data returned</dd>
</dl>
<p><strong>Return</strong></p>
<blockquote>
<div>0 on success
-EFAULT if read of config page header fails or data pointer not NULL
-ENOMEM if pci_alloc failed</div></blockquote>
<dl class="function">
<dt id="c.mpt_raid_phys_disk_get_num_paths">
int <code class="descname">mpt_raid_phys_disk_get_num_paths</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>&nbsp;ioc</em>, u8<em>&nbsp;phys_disk_num</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_raid_phys_disk_get_num_paths" title="Permalink to this definition">¶</a></dt>
<dd><p>returns number paths associated to this phys_num</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">MPT_ADAPTER</span> <span class="pre">*</span> <span class="pre">ioc</span></code></dt>
<dd>Pointer to a Adapter Structure</dd>
<dt><code class="docutils literal"><span class="pre">u8</span> <span class="pre">phys_disk_num</span></code></dt>
<dd>io unit unique phys disk num generated by the ioc</dd>
</dl>
<p><strong>Return</strong></p>
<blockquote>
<div>returns number paths</div></blockquote>
<dl class="function">
<dt id="c.mpt_raid_phys_disk_pg1">
int <code class="descname">mpt_raid_phys_disk_pg1</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>&nbsp;ioc</em>, u8<em>&nbsp;phys_disk_num</em>, RaidPhysDiskPage1_t *<em>&nbsp;phys_disk</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_raid_phys_disk_pg1" title="Permalink to this definition">¶</a></dt>
<dd><p>returns phys disk page 1</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">MPT_ADAPTER</span> <span class="pre">*</span> <span class="pre">ioc</span></code></dt>
<dd>Pointer to a Adapter Structure</dd>
<dt><code class="docutils literal"><span class="pre">u8</span> <span class="pre">phys_disk_num</span></code></dt>
<dd>io unit unique phys disk num generated by the ioc</dd>
<dt><code class="docutils literal"><span class="pre">RaidPhysDiskPage1_t</span> <span class="pre">*</span> <span class="pre">phys_disk</span></code></dt>
<dd>requested payload data returned</dd>
</dl>
<p><strong>Return</strong></p>
<blockquote>
<div>0 on success
-EFAULT if read of config page header fails or data pointer not NULL
-ENOMEM if pci_alloc failed</div></blockquote>
<dl class="function">
<dt id="c.mpt_findImVolumes">
int <code class="descname">mpt_findImVolumes</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>&nbsp;ioc</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_findImVolumes" title="Permalink to this definition">¶</a></dt>
<dd><p>Identify IDs of hidden disks and RAID Volumes</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">MPT_ADAPTER</span> <span class="pre">*</span> <span class="pre">ioc</span></code></dt>
<dd>Pointer to a Adapter Strucutre</dd>
</dl>
<p><strong>Return</strong></p>
<blockquote>
<div>0 on success
-EFAULT if read of config page header fails or data pointer not NULL
-ENOMEM if pci_alloc failed</div></blockquote>
<dl class="function">
<dt id="c.mpt_config">
int <code class="descname">mpt_config</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>&nbsp;ioc</em>, CONFIGPARMS *<em>&nbsp;pCfg</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic function to issue config message</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">MPT_ADAPTER</span> <span class="pre">*</span> <span class="pre">ioc</span></code></dt>
<dd>Pointer to an adapter structure</dd>
<dt><code class="docutils literal"><span class="pre">CONFIGPARMS</span> <span class="pre">*</span> <span class="pre">pCfg</span></code></dt>
<dd>Pointer to a configuration structure. Struct contains
action, page address, direction, physical address
and pointer to a configuration page header
Page header is updated.</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div>Returns 0 for success
-EPERM if not allowed due to ISR context
-EAGAIN if no msg frames currently available
-EFAULT for non-successful reply or no reply (timeout)</div></blockquote>
<dl class="function">
<dt id="c.mpt_print_ioc_summary">
void <code class="descname">mpt_print_ioc_summary</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>&nbsp;ioc</em>, char *<em>&nbsp;buffer</em>, int *<em>&nbsp;size</em>, int<em>&nbsp;len</em>, int<em>&nbsp;showlan</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_print_ioc_summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Write ASCII summary of IOC to a buffer.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">MPT_ADAPTER</span> <span class="pre">*</span> <span class="pre">ioc</span></code></dt>
<dd>Pointer to MPT_ADAPTER structure</dd>
<dt><code class="docutils literal"><span class="pre">char</span> <span class="pre">*</span> <span class="pre">buffer</span></code></dt>
<dd>Pointer to buffer where IOC summary info should be written</dd>
<dt><code class="docutils literal"><span class="pre">int</span> <span class="pre">*</span> <span class="pre">size</span></code></dt>
<dd>Pointer to number of bytes we wrote (set by this routine)</dd>
<dt><code class="docutils literal"><span class="pre">int</span> <span class="pre">len</span></code></dt>
<dd>Offset at which to start writing in buffer</dd>
<dt><code class="docutils literal"><span class="pre">int</span> <span class="pre">showlan</span></code></dt>
<dd>Display LAN stuff?</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div>This routine writes (english readable) ASCII text, which represents
a summary of IOC information, to a buffer.</div></blockquote>
<dl class="function">
<dt id="c.mpt_set_taskmgmt_in_progress_flag">
int <code class="descname">mpt_set_taskmgmt_in_progress_flag</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>&nbsp;ioc</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_set_taskmgmt_in_progress_flag" title="Permalink to this definition">¶</a></dt>
<dd><p>set flags associated with task management</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">MPT_ADAPTER</span> <span class="pre">*</span> <span class="pre">ioc</span></code></dt>
<dd>Pointer to MPT_ADAPTER structure</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div><p>Returns 0 for SUCCESS or -1 if FAILED.</p>
<p>If -1 is return, then it was not possible to set the flags</p>
</div></blockquote>
<dl class="function">
<dt id="c.mpt_clear_taskmgmt_in_progress_flag">
void <code class="descname">mpt_clear_taskmgmt_in_progress_flag</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>&nbsp;ioc</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_clear_taskmgmt_in_progress_flag" title="Permalink to this definition">¶</a></dt>
<dd><p>clear flags associated with task management</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">MPT_ADAPTER</span> <span class="pre">*</span> <span class="pre">ioc</span></code></dt>
<dd>Pointer to MPT_ADAPTER structure</dd>
</dl>
<dl class="function">
<dt id="c.mpt_halt_firmware">
void <code class="descname">mpt_halt_firmware</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>&nbsp;ioc</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_halt_firmware" title="Permalink to this definition">¶</a></dt>
<dd><p>Halts the firmware if it is operational and panic the kernel</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">MPT_ADAPTER</span> <span class="pre">*</span> <span class="pre">ioc</span></code></dt>
<dd>Pointer to MPT_ADAPTER structure</dd>
</dl>
<dl class="function">
<dt id="c.mpt_Soft_Hard_ResetHandler">
int <code class="descname">mpt_Soft_Hard_ResetHandler</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>&nbsp;ioc</em>, int<em>&nbsp;sleepFlag</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_Soft_Hard_ResetHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Try less expensive reset</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">MPT_ADAPTER</span> <span class="pre">*</span> <span class="pre">ioc</span></code></dt>
<dd>Pointer to MPT_ADAPTER structure</dd>
<dt><code class="docutils literal"><span class="pre">int</span> <span class="pre">sleepFlag</span></code></dt>
<dd>Indicates if sleep or schedule must be called.</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div>Returns 0 for SUCCESS or -1 if FAILED.
Try for softreset first, only if it fails go for expensive
HardReset.</div></blockquote>
<dl class="function">
<dt id="c.mpt_HardResetHandler">
int <code class="descname">mpt_HardResetHandler</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>&nbsp;ioc</em>, int<em>&nbsp;sleepFlag</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mpt_HardResetHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic reset handler</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">MPT_ADAPTER</span> <span class="pre">*</span> <span class="pre">ioc</span></code></dt>
<dd>Pointer to MPT_ADAPTER structure</dd>
<dt><code class="docutils literal"><span class="pre">int</span> <span class="pre">sleepFlag</span></code></dt>
<dd>Indicates if sleep or schedule must be called.</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div><p>Issues SCSI Task Management call based on input arg values.
If TaskMgmt fails, returns associated SCSI request.</p>
<p>Remark: _HardResetHandler can be invoked from an interrupt thread (timer)
or a non-interrupt thread.  In the former, must not call <code class="xref c c-func docutils literal"><span class="pre">schedule()</span></code>.</p>
</div></blockquote>
<p><strong>Note</strong></p>
<dl class="docutils">
<dt>A return of -1 is a FATAL error case, as it means a</dt>
<dd><p class="first">FW reload/initialization failed.</p>
<p class="last">Returns 0 for SUCCESS or -1 if FAILED.</p>
</dd>
</dl>
<dl class="function">
<dt id="c.mptscsih_info">
const char * <code class="descname">mptscsih_info</code><span class="sig-paren">(</span>struct Scsi_Host *<em>&nbsp;SChost</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mptscsih_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Return information about MPT adapter</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">Scsi_Host</span> <span class="pre">*</span> <span class="pre">SChost</span></code></dt>
<dd>Pointer to Scsi_Host structure</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div><p>(linux scsi_host_template.info routine)</p>
<p>Returns pointer to buffer where information was written.</p>
</div></blockquote>
<dl class="function">
<dt id="c.mptscsih_qcmd">
int <code class="descname">mptscsih_qcmd</code><span class="sig-paren">(</span>struct scsi_cmnd *<em>&nbsp;SCpnt</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mptscsih_qcmd" title="Permalink to this definition">¶</a></dt>
<dd><p>Primary Fusion MPT SCSI initiator IO start routine.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">scsi_cmnd</span> <span class="pre">*</span> <span class="pre">SCpnt</span></code></dt>
<dd>Pointer to scsi_cmnd structure</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div><p>(linux scsi_host_template.queuecommand routine)
This is the primary SCSI IO start routine.  Create a MPI SCSIIORequest
from a linux scsi_cmnd request and send it to the IOC.</p>
<p>Returns 0. (rtn value discarded by linux scsi mid-layer)</p>
</div></blockquote>
<dl class="function">
<dt id="c.mptscsih_IssueTaskMgmt">
int <code class="descname">mptscsih_IssueTaskMgmt</code><span class="sig-paren">(</span>MPT_SCSI_HOST *<em>&nbsp;hd</em>, u8<em>&nbsp;type</em>, u8<em>&nbsp;channel</em>, u8<em>&nbsp;id</em>, u64<em>&nbsp;lun</em>, int<em>&nbsp;ctx2abort</em>, ulong<em>&nbsp;timeout</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mptscsih_IssueTaskMgmt" title="Permalink to this definition">¶</a></dt>
<dd><p>Generic send Task Management function.</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">MPT_SCSI_HOST</span> <span class="pre">*</span> <span class="pre">hd</span></code></dt>
<dd>Pointer to MPT_SCSI_HOST structure</dd>
<dt><code class="docutils literal"><span class="pre">u8</span> <span class="pre">type</span></code></dt>
<dd>Task Management type</dd>
<dt><code class="docutils literal"><span class="pre">u8</span> <span class="pre">channel</span></code></dt>
<dd>channel number for task management</dd>
<dt><code class="docutils literal"><span class="pre">u8</span> <span class="pre">id</span></code></dt>
<dd>Logical Target ID for reset (if appropriate)</dd>
<dt><code class="docutils literal"><span class="pre">u64</span> <span class="pre">lun</span></code></dt>
<dd>Logical Unit for reset (if appropriate)</dd>
<dt><code class="docutils literal"><span class="pre">int</span> <span class="pre">ctx2abort</span></code></dt>
<dd>Context for the task to be aborted (if appropriate)</dd>
<dt><code class="docutils literal"><span class="pre">ulong</span> <span class="pre">timeout</span></code></dt>
<dd>timeout for task management control</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div><p>Remark: _HardResetHandler can be invoked from an interrupt thread (timer)
or a non-interrupt thread.  In the former, must not call <code class="xref c c-func docutils literal"><span class="pre">schedule()</span></code>.</p>
<p>Not all fields are meaningfull for all task types.</p>
<p>Returns 0 for SUCCESS, or FAILED.</p>
</div></blockquote>
<dl class="function">
<dt id="c.mptscsih_abort">
int <code class="descname">mptscsih_abort</code><span class="sig-paren">(</span>struct scsi_cmnd *<em>&nbsp;SCpnt</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mptscsih_abort" title="Permalink to this definition">¶</a></dt>
<dd><p>Abort linux scsi_cmnd routine, new_eh variant</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">scsi_cmnd</span> <span class="pre">*</span> <span class="pre">SCpnt</span></code></dt>
<dd>Pointer to scsi_cmnd structure, IO to be aborted</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div><p>(linux scsi_host_template.eh_abort_handler routine)</p>
<p>Returns SUCCESS or FAILED.</p>
</div></blockquote>
<dl class="function">
<dt id="c.mptscsih_dev_reset">
int <code class="descname">mptscsih_dev_reset</code><span class="sig-paren">(</span>struct scsi_cmnd *<em>&nbsp;SCpnt</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mptscsih_dev_reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a SCSI TARGET_RESET! new_eh variant</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">scsi_cmnd</span> <span class="pre">*</span> <span class="pre">SCpnt</span></code></dt>
<dd>Pointer to scsi_cmnd structure, IO which reset is due to</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div><p>(linux scsi_host_template.eh_dev_reset_handler routine)</p>
<p>Returns SUCCESS or FAILED.</p>
</div></blockquote>
<dl class="function">
<dt id="c.mptscsih_bus_reset">
int <code class="descname">mptscsih_bus_reset</code><span class="sig-paren">(</span>struct scsi_cmnd *<em>&nbsp;SCpnt</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mptscsih_bus_reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a SCSI BUS_RESET! new_eh variant</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">scsi_cmnd</span> <span class="pre">*</span> <span class="pre">SCpnt</span></code></dt>
<dd>Pointer to scsi_cmnd structure, IO which reset is due to</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div><p>(linux scsi_host_template.eh_bus_reset_handler routine)</p>
<p>Returns SUCCESS or FAILED.</p>
</div></blockquote>
<dl class="function">
<dt id="c.mptscsih_host_reset">
int <code class="descname">mptscsih_host_reset</code><span class="sig-paren">(</span>struct scsi_cmnd *<em>&nbsp;SCpnt</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mptscsih_host_reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform a SCSI host adapter RESET (new_eh variant)</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">struct</span> <span class="pre">scsi_cmnd</span> <span class="pre">*</span> <span class="pre">SCpnt</span></code></dt>
<dd>Pointer to scsi_cmnd structure, IO which reset is due to</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div><p>(linux scsi_host_template.eh_host_reset_handler routine)</p>
<p>Returns SUCCESS or FAILED.</p>
</div></blockquote>
<dl class="function">
<dt id="c.mptscsih_taskmgmt_complete">
int <code class="descname">mptscsih_taskmgmt_complete</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>&nbsp;ioc</em>, MPT_FRAME_HDR *<em>&nbsp;mf</em>, MPT_FRAME_HDR *<em>&nbsp;mr</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mptscsih_taskmgmt_complete" title="Permalink to this definition">¶</a></dt>
<dd><p>Registered with Fusion MPT base driver</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">MPT_ADAPTER</span> <span class="pre">*</span> <span class="pre">ioc</span></code></dt>
<dd>Pointer to MPT_ADAPTER structure</dd>
<dt><code class="docutils literal"><span class="pre">MPT_FRAME_HDR</span> <span class="pre">*</span> <span class="pre">mf</span></code></dt>
<dd>Pointer to SCSI task mgmt request frame</dd>
<dt><code class="docutils literal"><span class="pre">MPT_FRAME_HDR</span> <span class="pre">*</span> <span class="pre">mr</span></code></dt>
<dd>Pointer to SCSI task mgmt reply frame</dd>
</dl>
<p><strong>Description</strong></p>
<blockquote>
<div><p>This routine is called from mptbase.c::<code class="xref c c-func docutils literal"><span class="pre">mpt_interrupt()</span></code> at the completion
of any SCSI task management request.
This routine is registered with the MPT (base) driver at driver
load/init time via the <a class="reference internal" href="#c.mpt_register" title="mpt_register"><code class="xref c c-func docutils literal"><span class="pre">mpt_register()</span></code></a> API call.</p>
<p>Returns 1 indicating alloc’d request frame ptr should be freed.</p>
</div></blockquote>
<dl class="function">
<dt id="c.mptscsih_get_scsi_lookup">
struct scsi_cmnd * <code class="descname">mptscsih_get_scsi_lookup</code><span class="sig-paren">(</span>MPT_ADAPTER *<em>&nbsp;ioc</em>, int<em>&nbsp;i</em><span class="sig-paren">)</span><a class="headerlink" href="#c.mptscsih_get_scsi_lookup" title="Permalink to this definition">¶</a></dt>
<dd><p>retrieves scmd entry</p>
</dd></dl>

<p><strong>Parameters</strong></p>
<dl class="docutils">
<dt><code class="docutils literal"><span class="pre">MPT_ADAPTER</span> <span class="pre">*</span> <span class="pre">ioc</span></code></dt>
<dd>Pointer to MPT_ADAPTER structure</dd>
<dt><code class="docutils literal"><span class="pre">int</span> <span class="pre">i</span></code></dt>
<dd>index into the array</dd>
</dl>
<p><strong>Description</strong></p>
<p>Returns the scsi_cmd pointer</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="sound.html" class="btn btn-neutral float-right" title="Sound Devices" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="device_link.html" class="btn btn-neutral" title="Device links" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright The kernel development community

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    
    
      <script type="text/javascript">
          var DOCUMENTATION_OPTIONS = {
              URL_ROOT:'../',
              VERSION:'',
              LANGUAGE:'None',
              COLLAPSE_INDEX:false,
              FILE_SUFFIX:'.html',
              HAS_SOURCE:  true,
              SOURCELINK_SUFFIX: '.txt'
          };
      </script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
    

  

  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>